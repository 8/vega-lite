import { assert } from 'chai';
import { containsTimeUnit, convert, fieldExpr, formatExpression, TimeUnit } from '../src/timeunit';
describe('timeUnit', function () {
    describe('containsTimeUnit', function () {
        it('should return true for quarter given quarter', function () {
            var fullTimeUnit = TimeUnit.QUARTER;
            var timeUnit = TimeUnit.QUARTER;
            assert.equal(containsTimeUnit(fullTimeUnit, timeUnit), true);
        });
        it('should return true for yearquarter given quarter', function () {
            var fullTimeUnit = TimeUnit.YEARQUARTER;
            var timeUnit = TimeUnit.QUARTER;
            assert.equal(containsTimeUnit(fullTimeUnit, timeUnit), true);
        });
        it('should return true for SECONDS and MILLISECONDS given SECONDSMILLISECONDS', function () {
            var fullTimeUnit = TimeUnit.SECONDSMILLISECONDS;
            var timeUnit = TimeUnit.SECONDS;
            assert.equal(containsTimeUnit(fullTimeUnit, timeUnit), true);
        });
        it('should return true for MILLISECONDS given SECONDSMILLISECONDS', function () {
            var fullTimeUnit = TimeUnit.SECONDSMILLISECONDS;
            var timeUnit = TimeUnit.MILLISECONDS;
            assert.equal(containsTimeUnit(fullTimeUnit, timeUnit), true);
        });
        it('should return false for quarter given year', function () {
            var fullTimeUnit = TimeUnit.YEAR;
            var timeUnit = TimeUnit.QUARTER;
            assert.equal(containsTimeUnit(fullTimeUnit, timeUnit), false);
        });
        it('should return false for SECONDS given MILLISECONDS', function () {
            var fullTimeUnit = TimeUnit.MILLISECONDS;
            var timeUnit = TimeUnit.SECONDS;
            assert.equal(containsTimeUnit(fullTimeUnit, timeUnit), false);
        });
    });
    describe('fieldExpr', function () {
        it('should return correct field expression for YEARMONTHDATEHOURSMINUTESSECONDS', function () {
            assert.equal(fieldExpr(TimeUnit.YEARMONTHDATEHOURSMINUTESSECONDS, 'x'), 'datetime(year(datum["x"]), month(datum["x"]), date(datum["x"]), hours(datum["x"]), minutes(datum["x"]), seconds(datum["x"]), 0)');
        });
        it('should return correct field expression for QUARTER', function () {
            assert.equal(fieldExpr(TimeUnit.QUARTER, 'x'), 'datetime(0, (quarter(datum["x"])-1)*3, 1, 0, 0, 0, 0)');
        });
        it('should return correct field expression for DAY', function () {
            assert.equal(fieldExpr(TimeUnit.DAY, 'x'), 'datetime(2006, 0, day(datum["x"])+1, 0, 0, 0, 0)');
        });
        it('should return correct field expression for MILLISECONDS', function () {
            assert.equal(fieldExpr(TimeUnit.MILLISECONDS, 'x'), 'datetime(0, 0, 1, 0, 0, 0, milliseconds(datum["x"]))');
        });
        it('should return correct field expression with utc for MILLISECONDS', function () {
            assert.equal(fieldExpr(TimeUnit.UTCQUARTER, 'x'), 'datetime(0, (utcquarter(datum["x"])-1)*3, 1, 0, 0, 0, 0)');
            assert.equal(fieldExpr(TimeUnit.UTCMILLISECONDS, 'x'), 'datetime(0, 0, 1, 0, 0, 0, utcmilliseconds(datum["x"]))');
        });
    });
    describe('convert', function () {
        it('should throw an error for the DAY timeunit', function () {
            assert.throws(function () {
                convert(TimeUnit.DAY, new Date(2000, 11, 2, 23, 59, 59, 999));
            }, Error, 'Cannot convert to TimeUnits containing \'day\'');
        });
        it('should return expected result for YEARQUARTER', function () {
            var date = convert(TimeUnit.YEARQUARTER, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(2000, 9, 1, 0, 0, 0, 0).getTime());
        });
        it('should return expected result for UTCYEARQUARTER', function () {
            var date = convert(TimeUnit.UTCYEARQUARTER, new Date(Date.UTC(2000, 11, 2, 23, 59, 59, 999)));
            assert.equal(date.getTime(), new Date(Date.UTC(2000, 9, 1, 0, 0, 0, 0)).getTime());
        });
        it('should return expected result for YEARQUARTERMONTH', function () {
            var date = convert(TimeUnit.YEARQUARTERMONTH, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(2000, 11, 1, 0, 0, 0, 0).getTime());
        });
        it('should return expected result for YEARMONTH', function () {
            var date = convert(TimeUnit.YEARMONTH, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(2000, 11, 1, 0, 0, 0, 0).getTime());
        });
        it('should return expected result for UTCYEARMONTH', function () {
            var date = convert(TimeUnit.UTCYEARMONTH, new Date(Date.UTC(2000, 11, 2, 23, 59, 59, 999)));
            assert.equal(date.getTime(), new Date(Date.UTC(2000, 11, 1, 0, 0, 0, 0)).getTime());
        });
        it('should return expected result for UTCYEARMONTH', function () {
            var date = convert(TimeUnit.UTCYEAR, new Date(Date.UTC(2000, 11, 2, 23, 59, 59, 999)));
            assert.equal(date.getTime(), new Date(Date.UTC(2000, 0, 1, 0, 0, 0, 0)).getTime());
        });
        it('should return expected result for YEARMONTHDATE', function () {
            var date = convert(TimeUnit.YEARMONTHDATE, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(2000, 11, 2, 0, 0, 0, 0).getTime());
        });
        it('should return expected result for YEARMONTHDATEHOURS', function () {
            var date = convert(TimeUnit.YEARMONTHDATEHOURS, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(2000, 11, 2, 23, 0, 0, 0).getTime());
        });
        it('should return expected result for YEARMONTHDATEHOURSMINUTES', function () {
            var date = convert(TimeUnit.YEARMONTHDATEHOURSMINUTES, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(2000, 11, 2, 23, 59, 0, 0).getTime());
        });
        it('should return expected result for YEARMONTHDATEHOURSMINUTESSECONDS', function () {
            var date = convert(TimeUnit.YEARMONTHDATEHOURSMINUTESSECONDS, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(2000, 11, 2, 23, 59, 59, 0).getTime());
        });
        it('should return expected result for QUARTERMONTH', function () {
            var date = convert(TimeUnit.QUARTERMONTH, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(1900, 11, 1, 0, 0, 0, 0).getTime());
        });
        it('should return expected result for HOURSMINUTES', function () {
            var date = convert(TimeUnit.HOURSMINUTES, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(1900, 0, 1, 23, 59, 0, 0).getTime());
        });
        it('should return expected result for HOURSMINUTESSECONDS', function () {
            var date = convert(TimeUnit.HOURSMINUTESSECONDS, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(1900, 0, 1, 23, 59, 59, 0).getTime());
        });
        it('should return expected result for MINUTESSECONDS', function () {
            var date = convert(TimeUnit.MINUTESSECONDS, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(1900, 0, 1, 0, 59, 59, 0).getTime());
        });
        it('should return expected result for SECONDSMILLISECONDS', function () {
            var date = convert(TimeUnit.SECONDSMILLISECONDS, new Date(2000, 11, 2, 23, 59, 59, 999));
            assert.equal(date.getTime(), new Date(1900, 0, 1, 0, 0, 59, 999).getTime());
        });
    });
    describe('template', function () {
        it('should return correct template for YEARMONTHDATEHOURSMINUTESSECONDS', function () {
            assert.equal(formatExpression(TimeUnit.YEARMONTHDATEHOURSMINUTESSECONDS, 'datum.x', undefined, false), "timeFormat(datum.x, '%b %d, %Y %H:%M:%S')");
        });
        it('should return correct template for YEARMONTH (No comma)', function () {
            assert.equal(formatExpression(TimeUnit.YEARMONTH, 'datum.x', undefined, false), "timeFormat(datum.x, '%b %Y')");
        });
        it('should return correct template for DAY', function () {
            assert.equal(formatExpression(TimeUnit.DAY, 'datum.x', undefined, false), "timeFormat(datum.x, '%A')");
        });
        it('should return correct template for DAY (shortened)', function () {
            assert.equal(formatExpression(TimeUnit.DAY, 'datum.x', true, false), "timeFormat(datum.x, '%a')");
        });
        it('should return correct template for QUARTER', function () {
            assert.equal(formatExpression(TimeUnit.QUARTER, 'datum.x', undefined, false), "'Q' + quarter(datum.x)");
        });
        it('should return correct template for YEARQUARTER', function () {
            assert.equal(formatExpression(TimeUnit.YEARQUARTER, 'datum.x', undefined, false), "'Q' + quarter(datum.x) + ' ' + timeFormat(datum.x, '%Y')");
        });
        it('should return correct template for milliseconds', function () {
            assert.equal(formatExpression(TimeUnit.MILLISECONDS, 'datum.x', undefined, false), "timeFormat(datum.x, '%L')");
        });
        it('should return correct template for no timeUnit', function () {
            assert.equal(formatExpression(undefined, 'datum.x', undefined, false), undefined);
        });
        it('should return correct template for YEARMONTH (No comma) with utc scale', function () {
            assert.equal(formatExpression(TimeUnit.YEARMONTH, 'datum.x', undefined, true), "utcFormat(datum.x, '%b %Y')");
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltZXVuaXQudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3Rlc3QvdGltZXVuaXQudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsTUFBTSxFQUFDLE1BQU0sTUFBTSxDQUFDO0FBQzVCLE9BQU8sRUFBQyxnQkFBZ0IsRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLGdCQUFnQixFQUFFLFFBQVEsRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBR2pHLFFBQVEsQ0FBQyxVQUFVLEVBQUU7SUFDbkIsUUFBUSxDQUFDLGtCQUFrQixFQUFFO1FBQzNCLEVBQUUsQ0FBQyw4Q0FBOEMsRUFBRTtZQUNqRCxJQUFNLFlBQVksR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDO1lBQ3RDLElBQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUM7WUFDbEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLEVBQUUsUUFBUSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDL0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0RBQWtELEVBQUU7WUFDckQsSUFBTSxZQUFZLEdBQUcsUUFBUSxDQUFDLFdBQVcsQ0FBQztZQUMxQyxJQUFNLFFBQVEsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxFQUFFLFFBQVEsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQy9ELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJFQUEyRSxFQUFFO1lBQzlFLElBQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQztZQUNsRCxJQUFNLFFBQVEsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxFQUFFLFFBQVEsQ0FBQyxFQUFFLElBQUksQ0FB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UUFFSCxFQUFFLENBQUMsZ0RBQWdELEVBQUU7WUFDbkQsTUFBTSxDQUFDLEtBQUssQ0FDVixnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUUsS0FBSyxDQUFDLEVBQ2xFLDBEQUEwRCxDQUMzRCxDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsaURBQWlELEVBQUU7WUFDcEQsTUFBTSxDQUFDLEtBQUssQ0FDVixnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsWUFBWSxFQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUUsS0FBSyxDQUFDLEVBQ25FLDJCQUEyQixDQUM1QixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0RBQWdELEVBQUU7WUFDbkQsTUFBTSxDQUFDLEtBQUssQ0FDVixnQkFBZ0IsQ0FBQyxTQUFTLEVBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxLQUFLLENBQUMsRUFDdkQsU0FBUyxDQUNWLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3RUFBd0UsRUFBRTtZQUMzRSxNQUFNLENBQUMsS0FBSyxDQUNWLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsRUFDL0QsNkJBQTZCLENBQzlCLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2Fzc2VydH0gZnJvbSAnY2hhaSc7XG5pbXBvcnQge2NvbnRhaW5zVGltZVVuaXQsIGNvbnZlcnQsIGZpZWxkRXhwciwgZm9ybWF0RXhwcmVzc2lvbiwgVGltZVVuaXR9IGZyb20gJy4uL3NyYy90aW1ldW5pdCc7XG5cblxuZGVzY3JpYmUoJ3RpbWVVbml0JywgKCkgPT4ge1xuICBkZXNjcmliZSgnY29udGFpbnNUaW1lVW5pdCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0cnVlIGZvciBxdWFydGVyIGdpdmVuIHF1YXJ0ZXInLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGZ1bGxUaW1lVW5pdCA9IFRpbWVVbml0LlFVQVJURVI7XG4gICAgICBjb25zdCB0aW1lVW5pdCA9IFRpbWVVbml0LlFVQVJURVI7XG4gICAgICBhc3NlcnQuZXF1YWwoY29udGFpbnNUaW1lVW5pdChmdWxsVGltZVVuaXQsIHRpbWVVbml0KSwgdHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiB0cnVlIGZvciB5ZWFycXVhcnRlciBnaXZlbiBxdWFydGVyJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBmdWxsVGltZVVuaXQgPSBUaW1lVW5pdC5ZRUFSUVVBUlRFUjtcbiAgICAgIGNvbnN0IHRpbWVVbml0ID0gVGltZVVuaXQuUVVBUlRFUjtcbiAgICAgIGFzc2VydC5lcXVhbChjb250YWluc1RpbWVVbml0KGZ1bGxUaW1lVW5pdCwgdGltZVVuaXQpLCB0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRydWUgZm9yIFNFQ09ORFMgYW5kIE1JTExJU0VDT05EUyBnaXZlbiBTRUNPTkRTTUlMTElTRUNPTkRTJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBmdWxsVGltZVVuaXQgPSBUaW1lVW5pdC5TRUNPTkRTTUlMTElTRUNPTkRTO1xuICAgICAgY29uc3QgdGltZVVuaXQgPSBUaW1lVW5pdC5TRUNPTkRTO1xuICAgICAgYXNzZXJ0LmVxdWFsKGNvbnRhaW5zVGltZVVuaXQoZnVsbFRpbWVVbml0LCB0aW1lVW5pdCksIHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSBmb3IgTUlMTElTRUNPTkRTIGdpdmVuIFNFQ09ORFNNSUxMSVNFQ09ORFMnLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGZ1bGxUaW1lVW5pdCA9IFRpbWVVbml0LlNFQ09ORFNNSUxMSVNFQ09ORFM7XG4gICAgICBjb25zdCB0aW1lVW5pdCA9IFRpbWVVbml0Lk1JTExJU0VDT05EUztcbiAgICAgIGFzc2VydC5lcXVhbChjb250YWluc1RpbWVVbml0KGZ1bGxUaW1lVW5pdCwgdGltZVVuaXQpLCB0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGZhbHNlIGZvciBxdWFydGVyIGdpdmVuIHllYXInLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGZ1bGxUaW1lVW5pdCA9IFRpbWVVbml0LllFQVI7XG4gICAgICBjb25zdCB0aW1lVW5pdCA9IFRpbWVVbml0LlFVQVJURVI7XG4gICAgICBhc3NlcnQuZXF1YWwoY29udGFpbnNUaW1lVW5pdChmdWxsVGltZVVuaXQsIHRpbWVVbml0KSwgZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2UgZm9yIFNFQ09ORFMgZ2l2ZW4gTUlMTElTRUNPTkRTJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBmdWxsVGltZVVuaXQgPSBUaW1lVW5pdC5NSUxMSVNFQ09ORFM7XG4gICAgICBjb25zdCB0aW1lVW5pdCA9IFRpbWVVbml0LlNFQ09ORFM7XG4gICAgICBhc3NlcnQuZXF1YWwoY29udGFpbnNUaW1lVW5pdChmdWxsVGltZVVuaXQsIHRpbWVVbml0KSwgZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmllbGRFeHByJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgZmllbGQgZXhwcmVzc2lvbiBmb3IgWUVBUk1PTlRIREFURUhPVVJTTUlOVVRFU1NFQ09ORFMnLCAoKSA9PiB7XG4gICAgICBhc3NlcnQuZXF1YWwoXG4gICAgICAgIGZpZWxkRXhwcihUaW1lVW5pdC5ZRUFSTU9OVEhEQVRFSE9VUlNNSU5VVEVTU0VDT05EUywgJ3gnKSxcbiAgICAgICAgJ2RhdGV0aW1lKHllYXIoZGF0dW1bXCJ4XCJdKSwgbW9udGgoZGF0dW1bXCJ4XCJdKSwgZGF0ZShkYXR1bVtcInhcIl0pLCBob3VycyhkYXR1bVtcInhcIl0pLCBtaW51dGVzKGRhdHVtW1wieFwiXSksIHNlY29uZHMoZGF0dW1bXCJ4XCJdKSwgMCknXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBmaWVsZCBleHByZXNzaW9uIGZvciBRVUFSVEVSJywgKCkgPT4ge1xuICAgICAgYXNzZXJ0LmVxdWFsKFxuICAgICAgICBmaWVsZEV4cHIoVGltZVVuaXQuUVVBUlRFUiwgJ3gnKSxcbiAgICAgICAgJ2RhdGV0aW1lKDAsIChxdWFydGVyKGRhdHVtW1wieFwiXSktMSkqMywgMSwgMCwgMCwgMCwgMCknXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBmaWVsZCBleHByZXNzaW9uIGZvciBEQVknLCAoKSA9PiB7XG4gICAgICBhc3NlcnQuZXF1YWwoXG4gICAgICAgIGZpZWxkRXhwcihUaW1lVW5pdC5EQVksICd4JyksXG4gICAgICAgICdkYXRldGltZSgyMDA2LCAwLCBkYXkoZGF0dW1bXCJ4XCJdKSsxLCAwLCAwLCAwLCAwKSdcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IGZpZWxkIGV4cHJlc3Npb24gZm9yIE1JTExJU0VDT05EUycsICgpID0+IHtcbiAgICAgIGFzc2VydC5lcXVhbChcbiAgICAgICAgZmllbGRFeHByKFRpbWVVbml0Lk1JTExJU0VDT05EUywgJ3gnKSxcbiAgICAgICAgJ2RhdGV0aW1lKDAsIDAsIDEsIDAsIDAsIDAsIG1pbGxpc2Vjb25kcyhkYXR1bVtcInhcIl0pKSdcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IGZpZWxkIGV4cHJlc3Npb24gd2l0aCB1dGMgZm9yIE1JTExJU0VDT05EUycsICgpID0+IHtcbiAgICAgIGFzc2VydC5lcXVhbChcbiAgICAgICAgZmllbGRFeHByKFRpbWVVbml0LlVUQ1FVQVJURVIsICd4JyksXG4gICAgICAgICdkYXRldGltZSgwLCAodXRjcXVhcnRlcihkYXR1bVtcInhcIl0pLTEpKjMsIDEsIDAsIDAsIDAsIDApJ1xuICAgICAgKTtcblxuICAgICAgYXNzZXJ0LmVxdWFsKFxuICAgICAgICBmaWVsZEV4cHIoVGltZVVuaXQuVVRDTUlMTElTRUNPTkRTLCAneCcpLFxuICAgICAgICAnZGF0ZXRpbWUoMCwgMCwgMSwgMCwgMCwgMCwgdXRjbWlsbGlzZWNvbmRzKGRhdHVtW1wieFwiXSkpJ1xuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NvbnZlcnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBhbiBlcnJvciBmb3IgdGhlIERBWSB0aW1ldW5pdCcsIGZ1bmN0aW9uKCkge1xuICAgICAgYXNzZXJ0LnRocm93cyhmdW5jdGlvbigpIHtcbiAgICAgICAgY29udmVydChUaW1lVW5pdC5EQVksIG5ldyBEYXRlKDIwMDAsIDExLCAyLCAyMywgNTksIDU5LCA5OTkpKTtcbiAgICAgIH0sIEVycm9yLCAnQ2Fubm90IGNvbnZlcnQgdG8gVGltZVVuaXRzIGNvbnRhaW5pbmcgXFwnZGF5XFwnJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBleHBlY3RlZCByZXN1bHQgZm9yIFlFQVJRVUFSVEVSJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBkYXRlOiBEYXRlID0gY29udmVydChUaW1lVW5pdC5ZRUFSUVVBUlRFUiwgbmV3IERhdGUoMjAwMCwgMTEsIDIsIDIzLCA1OSwgNTksIDk5OSkpO1xuICAgICAgYXNzZXJ0LmVxdWFsKGRhdGUuZ2V0VGltZSgpLCBuZXcgRGF0ZSgyMDAwLCA5LCAxLCAwLCAwLCAwLCAwKS5nZXRUaW1lKCkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXhwZWN0ZWQgcmVzdWx0IGZvciBVVENZRUFSUVVBUlRFUicsIGZ1bmN0aW9uKCkge1xuICAgICAgY29uc3QgZGF0ZTogRGF0ZSA9IGNvbnZlcnQoVGltZVVuaXQuVVRDWUVBUlFVQVJURVIsIG5ldyBEYXRlKERhdGUuVVRDKDIwMDAsIDExLCAyLCAyMywgNTksIDU5LCA5OTkpKSk7XG4gICAgICBhc3NlcnQuZXF1YWwoZGF0ZS5nZXRUaW1lKCksIG5ldyBEYXRlKERhdGUuVVRDKDIwMDAsIDksIDEsIDAsIDAsIDAsIDApKS5nZXRUaW1lKCkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXhwZWN0ZWQgcmVzdWx0IGZvciBZRUFSUVVBUlRFUk1PTlRIJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBkYXRlOiBEYXRlID0gY29udmVydChUaW1lVW5pdC5ZRUFSUVVBUlRFUk1PTlRILCBuZXcgRGF0ZSgyMDAwLCAxMSwgMiwgMjMsIDU5LCA1OSwgOTk5KSk7XG4gICAgICBhc3NlcnQuZXF1YWwoZGF0ZS5nZXRUaW1lKCksIG5ldyBEYXRlKDIwMDAsIDExLCAxLCAwLCAwLCAwLCAwKS5nZXRUaW1lKCkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXhwZWN0ZWQgcmVzdWx0IGZvciBZRUFSTU9OVEgnLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGRhdGU6IERhdGUgPSBjb252ZXJ0KFRpbWVVbml0LllFQVJNT05USCwgbmV3IERhdGUoMjAwMCwgMTEsIDIsIDIzLCA1OSwgNTksIDk5OSkpO1xuICAgICAgYXNzZXJ0LmVxdWFsKGRhdGUuZ2V0VGltZSgpLCBuZXcgRGF0ZSgyMDAwLCAxMSwgMSwgMCwgMCwgMCwgMCkuZ2V0VGltZSgpKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGV4cGVjdGVkIHJlc3VsdCBmb3IgVVRDWUVBUk1PTlRIJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBkYXRlOiBEYXRlID0gY29udmVydChUaW1lVW5pdC5VVENZRUFSTU9OVEgsIG5ldyBEYXRlKERhdGUuVVRDKDIwMDAsIDExLCAyLCAyMywgNTksIDU5LCA5OTkpKSk7XG4gICAgICBhc3NlcnQuZXF1YWwoZGF0ZS5nZXRUaW1lKCksIG5ldyBEYXRlKERhdGUuVVRDKDIwMDAsIDExLCAxLCAwLCAwLCAwLCAwKSkuZ2V0VGltZSgpKTtcbiAgICB9KTtcblxuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXhwZWN0ZWQgcmVzdWx0IGZvciBVVENZRUFSTU9OVEgnLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGRhdGU6IERhdGUgPSBjb252ZXJ0KFRpbWVVbml0LlVUQ1lFQVIsIG5ldyBEYXRlKERhdGUuVVRDKDIwMDAsIDExLCAyLCAyMywgNTksIDU5LCA5OTkpKSk7XG4gICAgICBhc3NlcnQuZXF1YWwoZGF0ZS5nZXRUaW1lKCksIG5ldyBEYXRlKERhdGUuVVRDKDIwMDAsIDAsIDEsIDAsIDAsIDAsIDApKS5nZXRUaW1lKCkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXhwZWN0ZWQgcmVzdWx0IGZvciBZRUFSTU9OVEhEQVRFJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBkYXRlOiBEYXRlID0gY29udmVydChUaW1lVW5pdC5ZRUFSTU9OVEhEQVRFLCBuZXcgRGF0ZSgyMDAwLCAxMSwgMiwgMjMsIDU5LCA1OSwgOTk5KSk7XG4gICAgICBhc3NlcnQuZXF1YWwoZGF0ZS5nZXRUaW1lKCksIG5ldyBEYXRlKDIwMDAsIDExLCAyLCAwLCAwLCAwLCAwKS5nZXRUaW1lKCkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXhwZWN0ZWQgcmVzdWx0IGZvciBZRUFSTU9OVEhEQVRFSE9VUlMnLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGRhdGU6IERhdGUgPSBjb252ZXJ0KFRpbWVVbml0LllFQVJNT05USERBVEVIT1VSUywgbmV3IERhdGUoMjAwMCwgMTEsIDIsIDIzLCA1OSwgNTksIDk5OSkpO1xuICAgICAgYXNzZXJ0LmVxdWFsKGRhdGUuZ2V0VGltZSgpLCBuZXcgRGF0ZSgyMDAwLCAxMSwgMiwgMjMsIDAsIDAsIDApLmdldFRpbWUoKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBleHBlY3RlZCByZXN1bHQgZm9yIFlFQVJNT05USERBVEVIT1VSU01JTlVURVMnLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGRhdGU6IERhdGUgPSBjb252ZXJ0KFRpbWVVbml0LllFQVJNT05USERBVEVIT1VSU01JTlVURVMsIG5ldyBEYXRlKDIwMDAsIDExLCAyLCAyMywgNTksIDU5LCA5OTkpKTtcbiAgICAgIGFzc2VydC5lcXVhbChkYXRlLmdldFRpbWUoKSwgbmV3IERhdGUoMjAwMCwgMTEsIDIsIDIzLCA1OSwgMCwgMCkuZ2V0VGltZSgpKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGV4cGVjdGVkIHJlc3VsdCBmb3IgWUVBUk1PTlRIREFURUhPVVJTTUlOVVRFU1NFQ09ORFMnLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGRhdGU6IERhdGUgPSBjb252ZXJ0KFRpbWVVbml0LllFQVJNT05USERBVEVIT1VSU01JTlVURVNTRUNPTkRTLCBuZXcgRGF0ZSgyMDAwLCAxMSwgMiwgMjMsIDU5LCA1OSwgOTk5KSk7XG4gICAgICBhc3NlcnQuZXF1YWwoZGF0ZS5nZXRUaW1lKCksIG5ldyBEYXRlKDIwMDAsIDExLCAyLCAyMywgNTksIDU5LCAwKS5nZXRUaW1lKCkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXhwZWN0ZWQgcmVzdWx0IGZvciBRVUFSVEVSTU9OVEgnLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGRhdGU6IERhdGUgPSBjb252ZXJ0KFRpbWVVbml0LlFVQVJURVJNT05USCwgbmV3IERhdGUoMjAwMCwgMTEsIDIsIDIzLCA1OSwgNTksIDk5OSkpO1xuICAgICAgYXNzZXJ0LmVxdWFsKGRhdGUuZ2V0VGltZSgpLCBuZXcgRGF0ZSgxOTAwLCAxMSwgMSwgMCwgMCwgMCwgMCkuZ2V0VGltZSgpKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGV4cGVjdGVkIHJlc3VsdCBmb3IgSE9VUlNNSU5VVEVTJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBkYXRlOiBEYXRlID0gY29udmVydChUaW1lVW5pdC5IT1VSU01JTlVURVMsIG5ldyBEYXRlKDIwMDAsIDExLCAyLCAyMywgNTksIDU5LCA5OTkpKTtcbiAgICAgIGFzc2VydC5lcXVhbChkYXRlLmdldFRpbWUoKSwgbmV3IERhdGUoMTkwMCwgMCwgMSwgMjMsIDU5LCAwLCAwKS5nZXRUaW1lKCkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXhwZWN0ZWQgcmVzdWx0IGZvciBIT1VSU01JTlVURVNTRUNPTkRTJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBkYXRlOiBEYXRlID0gY29udmVydChUaW1lVW5pdC5IT1VSU01JTlVURVNTRUNPTkRTLCBuZXcgRGF0ZSgyMDAwLCAxMSwgMiwgMjMsIDU5LCA1OSwgOTk5KSk7XG4gICAgICBhc3NlcnQuZXF1YWwoZGF0ZS5nZXRUaW1lKCksIG5ldyBEYXRlKDE5MDAsIDAsIDEsIDIzLCA1OSwgNTksIDApLmdldFRpbWUoKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBleHBlY3RlZCByZXN1bHQgZm9yIE1JTlVURVNTRUNPTkRTJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBkYXRlOiBEYXRlID0gY29udmVydChUaW1lVW5pdC5NSU5VVEVTU0VDT05EUywgbmV3IERhdGUoMjAwMCwgMTEsIDIsIDIzLCA1OSwgNTksIDk5OSkpO1xuICAgICAgYXNzZXJ0LmVxdWFsKGRhdGUuZ2V0VGltZSgpLCBuZXcgRGF0ZSgxOTAwLCAwLCAxLCAwLCA1OSwgNTksIDApLmdldFRpbWUoKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBleHBlY3RlZCByZXN1bHQgZm9yIFNFQ09ORFNNSUxMSVNFQ09ORFMnLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGRhdGU6IERhdGUgPSBjb252ZXJ0KFRpbWVVbml0LlNFQ09ORFNNSUxMSVNFQ09ORFMsIG5ldyBEYXRlKDIwMDAsIDExLCAyLCAyMywgNTksIDU5LCA5OTkpKTtcbiAgICAgIGFzc2VydC5lcXVhbChkYXRlLmdldFRpbWUoKSwgbmV3IERhdGUoMTkwMCwgMCwgMSwgMCwgMCwgNTksIDk5OSkuZ2V0VGltZSgpKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3RlbXBsYXRlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgdGVtcGxhdGUgZm9yIFlFQVJNT05USERBVEVIT1VSU01JTlVURVNTRUNPTkRTJywgKCkgPT4ge1xuICAgICAgYXNzZXJ0LmVxdWFsKFxuICAgICAgICBmb3JtYXRFeHByZXNzaW9uKFRpbWVVbml0LllFQVJNT05USERBVEVIT1VSU01JTlVURVNTRUNPTkRTLCdkYXR1bS54JywgdW5kZWZpbmVkLCBmYWxzZSksXG4gICAgICAgIFwidGltZUZvcm1hdChkYXR1bS54LCAnJWIgJWQsICVZICVIOiVNOiVTJylcIlxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgdGVtcGxhdGUgZm9yIFlFQVJNT05USCAoTm8gY29tbWEpJywgKCkgPT4ge1xuICAgICAgYXNzZXJ0LmVxdWFsKFxuICAgICAgICBmb3JtYXRFeHByZXNzaW9uKFRpbWVVbml0LllFQVJNT05USCwnZGF0dW0ueCcsIHVuZGVmaW5lZCwgZmFsc2UpLFxuICAgICAgICBcInRpbWVGb3JtYXQoZGF0dW0ueCwgJyViICVZJylcIlxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgdGVtcGxhdGUgZm9yIERBWScsICgpID0+IHtcbiAgICAgIGFzc2VydC5lcXVhbChcbiAgICAgICAgZm9ybWF0RXhwcmVzc2lvbihUaW1lVW5pdC5EQVksJ2RhdHVtLngnLCB1bmRlZmluZWQsIGZhbHNlKSxcbiAgICAgICAgXCJ0aW1lRm9ybWF0KGRhdHVtLngsICclQScpXCJcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IHRlbXBsYXRlIGZvciBEQVkgKHNob3J0ZW5lZCknLCAoKSA9PiB7XG4gICAgICBhc3NlcnQuZXF1YWwoXG4gICAgICAgIGZvcm1hdEV4cHJlc3Npb24oVGltZVVuaXQuREFZLCdkYXR1bS54JywgdHJ1ZSwgZmFsc2UpLFxuICAgICAgICBcInRpbWVGb3JtYXQoZGF0dW0ueCwgJyVhJylcIlxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgdGVtcGxhdGUgZm9yIFFVQVJURVInLCAoKSA9PiB7XG4gICAgICBhc3NlcnQuZXF1YWwoXG4gICAgICAgIGZvcm1hdEV4cHJlc3Npb24oVGltZVVuaXQuUVVBUlRFUiwnZGF0dW0ueCcsIHVuZGVmaW5lZCwgZmFsc2UpLFxuICAgICAgICBcIidRJyArIHF1YXJ0ZXIoZGF0dW0ueClcIlxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgdGVtcGxhdGUgZm9yIFlFQVJRVUFSVEVSJywgKCkgPT4ge1xuICAgICAgYXNzZXJ0LmVxdWFsKFxuICAgICAgICBmb3JtYXRFeHByZXNzaW9uKFRpbWVVbml0LllFQVJRVUFSVEVSLCdkYXR1bS54JywgdW5kZWZpbmVkLCBmYWxzZSksXG4gICAgICAgIFwiJ1EnICsgcXVhcnRlcihkYXR1bS54KSArICcgJyArIHRpbWVGb3JtYXQoZGF0dW0ueCwgJyVZJylcIlxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgdGVtcGxhdGUgZm9yIG1pbGxpc2Vjb25kcycsICgpID0+IHtcbiAgICAgIGFzc2VydC5lcXVhbChcbiAgICAgICAgZm9ybWF0RXhwcmVzc2lvbihUaW1lVW5pdC5NSUxMSVNFQ09ORFMsJ2RhdHVtLngnLCB1bmRlZmluZWQsIGZhbHNlKSxcbiAgICAgICAgXCJ0aW1lRm9ybWF0KGRhdHVtLngsICclTCcpXCJcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IHRlbXBsYXRlIGZvciBubyB0aW1lVW5pdCcsICgpID0+IHtcbiAgICAgIGFzc2VydC5lcXVhbChcbiAgICAgICAgZm9ybWF0RXhwcmVzc2lvbih1bmRlZmluZWQsJ2RhdHVtLngnLCB1bmRlZmluZWQsIGZhbHNlKSxcbiAgICAgICAgdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCB0ZW1wbGF0ZSBmb3IgWUVBUk1PTlRIIChObyBjb21tYSkgd2l0aCB1dGMgc2NhbGUnLCAoKSA9PiB7XG4gICAgICBhc3NlcnQuZXF1YWwoXG4gICAgICAgIGZvcm1hdEV4cHJlc3Npb24oVGltZVVuaXQuWUVBUk1PTlRILCdkYXR1bS54JywgdW5kZWZpbmVkLCB0cnVlKSxcbiAgICAgICAgXCJ1dGNGb3JtYXQoZGF0dW0ueCwgJyViICVZJylcIlxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==