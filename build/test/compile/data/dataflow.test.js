/* tslint:disable:quotemark */
import { assert } from 'chai';
import { DataFlowNode } from '../../../src/compile/data/dataflow';
describe('compile/data/dataflow', function () {
    describe('DataFlowNode', function () {
        describe('swap', function () {
            it('should correctly swap two nodes in a simple chain', function () {
                var a = new DataFlowNode(null, 'a');
                var b = new DataFlowNode(a, 'b');
                var c = new DataFlowNode(b, 'c');
                var d = new DataFlowNode(c, 'd');
                c.swapWithParent();
                assert.equal(a.numChildren(), 1);
                assert.equal(a.children[0].debugName, 'c');
                assert.equal(b.numChildren(), 1);
                assert.equal(b.children[0].debugName, 'd');
                assert.equal(c.numChildren(), 1);
                assert.equal(c.children[0].debugName, 'b');
                assert.equal(d.numChildren(), 0);
            });
            it('should correctly swap two nodes', function () {
                var root = new DataFlowNode(null, 'root');
                var parent = new DataFlowNode(root, 'parent');
                var node = new DataFlowNode(parent, 'node');
                var child1 = new DataFlowNode(node, 'child1');
                var child2 = new DataFlowNode(node, 'child2');
                var parentChild1 = new DataFlowNode(parent, 'parentChild1');
                var parentChild2 = new DataFlowNode(parent, 'parentChild2');
                node.swapWithParent();
                assert.equal(root.numChildren(), 1);
                assert.equal(root.children[0].debugName, 'node');
                assert.equal(node.parent.debugName, 'root');
                assert.equal(node.numChildren(), 1);
                assert.equal(node.children[0].debugName, 'parent');
                assert.equal(parent.parent.debugName, 'node');
                assert.equal(parent.numChildren(), 4);
                parent.children.forEach(function (c) {
                    assert.equal(c.numChildren(), 0);
                    assert.equal(c.parent.debugName, 'parent');
                });
                assert.equal(child1.debugName, 'child1');
                assert.equal(child2.debugName, 'child2');
                assert.equal(parentChild1.debugName, 'parentChild1');
                assert.equal(parentChild2.debugName, 'parentChild2');
            });
        });
        describe('remove', function () {
            it('should remove node from dataflow', function () {
                var a = new DataFlowNode(null, 'a');
                var b = new DataFlowNode(a, 'b');
                var c = new DataFlowNode(b, 'c');
                assert.deepEqual(a.children, [b]);
                assert.equal(b.parent, a);
                assert.equal(c.parent, b);
                b.remove();
                assert.deepEqual(a.children, [c]);
                assert.equal(c.parent, a);
            });
        });
        describe('insertAsParentOf', function () {
            it('should insert node into dataflow', function () {
                var a = new DataFlowNode(null, 'a');
                var anotherChild = new DataFlowNode(a, 'a');
                var b = new DataFlowNode(null, 'b');
                var c = new DataFlowNode(a, 'c');
                b.insertAsParentOf(c);
                assert.sameDeepMembers(a.children, [anotherChild, b]);
                assert.equal(b.parent, a);
                assert.equal(c.parent, b);
                assert.equal(anotherChild.parent, a);
            });
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWZsb3cudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Rlc3QvY29tcGlsZS9kYXRhL2RhdGFmbG93LnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsOEJBQThCO0FBRTlCLE9BQU8sRUFBQyxNQUFNLEVBQUMsTUFBTSxNQUFNLENBQUM7QUFDNUIsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLG9DQUFvQyxDQUFDO0FBRWhFLFFBQVEsQ0FBQyx1QkFBdUIsRUFBRTtJQUNoQyxRQUFRLENBQUMsY0FBYyxFQUFFO1FBQ3ZCLFFBQVEsQ0FBQyxNQUFNLEVBQUU7WUFDZixFQUFFLENBQUMsbURBQW1ELEVBQUU7Z0JBQ3RELElBQU0sQ0FBQyxHQUFHLElBQUksWUFBWSxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFDdEMsSUFBTSxDQUFDLEdBQUcsSUFBSSxZQUFZLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUVuQyxJQUFNLENBQUMsR0FBRyxJQUFJLFlBQVksQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7Z0JBRW5DLElBQU0sQ0FBQyxHQUFHLElBQUksWUFBWSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFFbkMsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDO2dCQUVuQixNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDakMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFFM0MsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ2pDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMs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QUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7Z0JBRW5DLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFFdEIsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3RELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDMUIsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUMxQixNQUFNLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDdkMsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiB0c2xpbnQ6ZGlzYWJsZTpxdW90ZW1hcmsgKi9cblxuaW1wb3J0IHthc3NlcnR9IGZyb20gJ2NoYWknO1xuaW1wb3J0IHtEYXRhRmxvd05vZGV9IGZyb20gJy4uLy4uLy4uL3NyYy9jb21waWxlL2RhdGEvZGF0YWZsb3cnO1xuXG5kZXNjcmliZSgnY29tcGlsZS9kYXRhL2RhdGFmbG93JywgZnVuY3Rpb24oKSB7XG4gIGRlc2NyaWJlKCdEYXRhRmxvd05vZGUnLCBmdW5jdGlvbigpIHtcbiAgICBkZXNjcmliZSgnc3dhcCcsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgY29ycmVjdGx5IHN3YXAgdHdvIG5vZGVzIGluIGEgc2ltcGxlIGNoYWluJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IGEgPSBuZXcgRGF0YUZsb3dOb2RlKG51bGwsICdhJyk7XG4gICAgICAgIGNvbnN0IGIgPSBuZXcgRGF0YUZsb3dOb2RlKGEsICdiJyk7XG5cbiAgICAgICAgY29uc3QgYyA9IG5ldyBEYXRhRmxvd05vZGUoYiwgJ2MnKTtcblxuICAgICAgICBjb25zdCBkID0gbmV3IERhdGFGbG93Tm9kZShjLCAnZCcpO1xuXG4gICAgICAgIGMuc3dhcFdpdGhQYXJlbnQoKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoYS5udW1DaGlsZHJlbigpLCAxKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGEuY2hpbGRyZW5bMF0uZGVidWdOYW1lLCAnYycpO1xuXG4gICAgICAgIGFzc2VydC5lcXVhbChiLm51bUNoaWxkcmVuKCksIDEpO1xuICAgICAgICBhc3NlcnQuZXF1YWwoYi5jaGlsZHJlblswXS5kZWJ1Z05hbWUsICdkJyk7XG5cbiAgICAgICAgYXNzZXJ0LmVxdWFsKGMubnVtQ2hpbGRyZW4oKSwgMSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChjLmNoaWxkcmVuWzBdLmRlYnVnTmFtZSwgJ2InKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoZC5udW1DaGlsZHJlbigpLCAwKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGNvcnJlY3RseSBzd2FwIHR3byBub2RlcycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCByb290ID0gbmV3IERhdGFGbG93Tm9kZShudWxsLCAncm9vdCcpO1xuICAgICAgICBjb25zdCBwYXJlbnQgPSBuZXcgRGF0YUZsb3dOb2RlKHJvb3QsICdwYXJlbnQnKTtcblxuICAgICAgICBjb25zdCBub2RlID0gbmV3IERhdGFGbG93Tm9kZShwYXJlbnQsICdub2RlJyk7XG5cbiAgICAgICAgY29uc3QgY2hpbGQxID0gbmV3IERhdGFGbG93Tm9kZShub2RlLCAnY2hpbGQxJyk7XG4gICAgICAgIGNvbnN0IGNoaWxkMiA9IG5ldyBEYXRhRmxvd05vZGUobm9kZSwgJ2NoaWxkMicpO1xuXG4gICAgICAgIGNvbnN0IHBhcmVudENoaWxkMSA9IG5ldyBEYXRhRmxvd05vZGUocGFyZW50LCAncGFyZW50Q2hpbGQxJyk7XG4gICAgICAgIGNvbnN0IHBhcmVudENoaWxkMiA9IG5ldyBEYXRhRmxvd05vZGUocGFyZW50LCAncGFyZW50Q2hpbGQyJyk7XG5cbiAgICAgICAgbm9kZS5zd2FwV2l0aFBhcmVudCgpO1xuXG4gICAgICAgIGFzc2VydC5lcXVhbChyb290Lm51bUNoaWxkcmVuKCksIDEpO1xuICAgICAgICBhc3NlcnQuZXF1YWwocm9vdC5jaGlsZHJlblswXS5kZWJ1Z05hbWUsICdub2RlJyk7XG4gICAgICAgIGFzc2VydC5lcXVhbChub2RlLnBhcmVudC5kZWJ1Z05hbWUsICdyb290Jyk7XG5cbiAgICAgICAgYXNzZXJ0LmVxdWFsKG5vZGUubnVtQ2hpbGRyZW4oKSwgMSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChub2RlLmNoaWxkcmVuWzBdLmRlYnVnTmFtZSwgJ3BhcmVudCcpO1xuICAgICAgICBhc3NlcnQuZXF1YWwocGFyZW50LnBhcmVudC5kZWJ1Z05hbWUsICdub2RlJyk7XG5cbiAgICAgICAgYXNzZXJ0LmVxdWFsKHBhcmVudC5udW1DaGlsZHJlbigpLCA0KTtcbiAgICAgICAgcGFyZW50LmNoaWxkcmVuLmZvckVhY2goYyA9PiB7XG4gICAgICAgICAgYXNzZXJ0LmVxdWFsKGMubnVtQ2hpbGRyZW4oKSwgMCk7XG4gICAgICAgICAgYXNzZXJ0LmVxdWFsKGMucGFyZW50LmRlYnVnTmFtZSwgJ3BhcmVudCcpO1xuICAgICAgICB9KTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoY2hpbGQxLmRlYnVnTmFtZSwgJ2NoaWxkMScpO1xuICAgICAgICBhc3NlcnQuZXF1YWwoY2hpbGQyLmRlYnVnTmFtZSwgJ2NoaWxkMicpO1xuICAgICAgICBhc3NlcnQuZXF1YWwocGFyZW50Q2hpbGQxLmRlYnVnTmFtZSwgJ3BhcmVudENoaWxkMScpO1xuICAgICAgICBhc3NlcnQuZXF1YWwocGFyZW50Q2hpbGQyLmRlYnVnTmFtZSwgJ3BhcmVudENoaWxkMicpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgncmVtb3ZlJywgZnVuY3Rpb24oKSB7XG4gICAgICBpdCgnc2hvdWxkIHJlbW92ZSBub2RlIGZyb20gZGF0YWZsb3cnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3QgYSA9IG5ldyBEYXRhRmxvd05vZGUobnVsbCwgJ2EnKTtcbiAgICAgICAgY29uc3QgYiA9IG5ldyBEYXRhRmxvd05vZGUoYSwgJ2InKTtcblxuICAgICAgICBjb25zdCBjID0gbmV3IERhdGFGbG93Tm9kZShiLCAnYycpO1xuXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYS5jaGlsZHJlbiwgW2JdKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGIucGFyZW50LCBhKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGMucGFyZW50LCBiKTtcblxuICAgICAgICBiLnJlbW92ZSgpO1xuXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYS5jaGlsZHJlbiwgW2NdKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGMucGFyZW50LCBhKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2luc2VydEFzUGFyZW50T2YnLCBmdW5jdGlvbigpIHtcbiAgICAgIGl0KCdzaG91bGQgaW5zZXJ0IG5vZGUgaW50byBkYXRhZmxvdycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCBhID0gbmV3IERhdGFGbG93Tm9kZShudWxsLCAnYScpO1xuICAgICAgICBjb25zdCBhbm90aGVyQ2hpbGQgPSBuZXcgRGF0YUZsb3dOb2RlKGEsICdhJyk7XG4gICAgICAgIGNvbnN0IGIgPSBuZXcgRGF0YUZsb3dOb2RlKG51bGwsICdiJyk7XG4gICAgICAgIGNvbnN0IGMgPSBuZXcgRGF0YUZsb3dOb2RlKGEsICdjJyk7XG5cbiAgICAgICAgYi5pbnNlcnRBc1BhcmVudE9mKGMpO1xuXG4gICAgICAgIGFzc2VydC5zYW1lRGVlcE1lbWJlcnMoYS5jaGlsZHJlbiwgW2Fub3RoZXJDaGlsZCwgYl0pO1xuICAgICAgICBhc3NlcnQuZXF1YWwoYi5wYXJlbnQsIGEpO1xuICAgICAgICBhc3NlcnQuZXF1YWwoYy5wYXJlbnQsIGIpO1xuICAgICAgICBhc3NlcnQuZXF1YWwoYW5vdGhlckNoaWxkLnBhcmVudCwgYSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==