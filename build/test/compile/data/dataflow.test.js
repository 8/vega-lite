"use strict";
/* tslint:disable:quotemark */
Object.defineProperty(exports, "__esModule", { value: true });
var chai_1 = require("chai");
var dataflow_1 = require("../../../src/compile/data/dataflow");
describe('compile/data/dataflow', function () {
    describe('DataFlowNode', function () {
        describe('swap', function () {
            it('should correctly swap two nodes in a simple chain', function () {
                var a = new dataflow_1.DataFlowNode('a');
                var b = new dataflow_1.DataFlowNode('b');
                b.parent = a;
                var c = new dataflow_1.DataFlowNode('c');
                c.parent = b;
                var d = new dataflow_1.DataFlowNode('d');
                d.parent = c;
                c.swapWithParent();
                chai_1.assert.equal(a.numChildren(), 1);
                chai_1.assert.equal(a.children[0].debugName, 'c');
                chai_1.assert.equal(b.numChildren(), 1);
                chai_1.assert.equal(b.children[0].debugName, 'd');
                chai_1.assert.equal(c.numChildren(), 1);
                chai_1.assert.equal(c.children[0].debugName, 'b');
                chai_1.assert.equal(d.numChildren(), 0);
            });
            it('should correctly swap two nodes', function () {
                var root = new dataflow_1.DataFlowNode('root');
                var parent = new dataflow_1.DataFlowNode('parent');
                parent.parent = root;
                var node = new dataflow_1.DataFlowNode('node');
                node.parent = parent;
                var child1 = new dataflow_1.DataFlowNode('child1');
                child1.parent = node;
                var child2 = new dataflow_1.DataFlowNode('child2');
                child2.parent = node;
                var parentChild1 = new dataflow_1.DataFlowNode('parentChild1');
                parentChild1.parent = parent;
                var parentChild2 = new dataflow_1.DataFlowNode('parentChild2');
                parentChild2.parent = parent;
                node.swapWithParent();
                chai_1.assert.equal(root.numChildren(), 1);
                chai_1.assert.equal(root.children[0].debugName, 'node');
                chai_1.assert.equal(node.parent.debugName, 'root');
                chai_1.assert.equal(node.numChildren(), 1);
                chai_1.assert.equal(node.children[0].debugName, 'parent');
                chai_1.assert.equal(parent.parent.debugName, 'node');
                chai_1.assert.equal(parent.numChildren(), 4);
                parent.children.forEach(function (c) {
                    chai_1.assert.equal(c.numChildren(), 0);
                    chai_1.assert.equal(c.parent.debugName, 'parent');
                });
            });
        });
        describe('remove', function () {
            it('should remove node from dataflow', function () {
                var a = new dataflow_1.DataFlowNode('a');
                var b = new dataflow_1.DataFlowNode('b');
                b.parent = a;
                var c = new dataflow_1.DataFlowNode('c');
                c.parent = b;
                chai_1.assert.deepEqual(a.children, [b]);
                chai_1.assert.equal(b.parent, a);
                chai_1.assert.equal(c.parent, b);
                b.remove();
                chai_1.assert.deepEqual(a.children, [c]);
                chai_1.assert.equal(c.parent, a);
            });
        });
        describe('insertAsParentOf', function () {
            it('should insert node into dataflow', function () {
                var a = new dataflow_1.DataFlowNode('a');
                var anotherChild = new dataflow_1.DataFlowNode('a');
                var b = new dataflow_1.DataFlowNode('b');
                var c = new dataflow_1.DataFlowNode('c');
                anotherChild.parent = a;
                c.parent = a;
                b.insertAsParentOf(c);
                chai_1.assert.sameDeepMembers(a.children, [anotherChild, b]);
                chai_1.assert.equal(b.parent, a);
                chai_1.assert.equal(c.parent, b);
                chai_1.assert.equal(anotherChild.parent, a);
            });
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWZsb3cudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Rlc3QvY29tcGlsZS9kYXRhL2RhdGFmbG93LnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLDhCQUE4Qjs7QUFFOUIsNkJBQTRCO0FBQzVCLCtEQUFnRTtBQUVoRSxRQUFRLENBQUMsdUJBQXVCLEVBQUU7SUFDaEMsUUFBUSxDQUFDLGNBQWMsRUFBRTtRQUN2QixRQUFRLENBQUMsTUFBTSxFQUFFO1lBQ2YsRUFBRSxDQUFDLG1EQUFtRCxFQUFFO2dCQUN0RCxJQUFNLENBQUMsR0FBRyxJQUFJLHVCQUFZLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ2hDLElBQU0sQ0FBQyxHQUFHLElBQUksdUJBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDaEMsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7Z0JBRWIsSUFBTSxDQUFDLEdBQUcsSUFBSSx1QkFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNoQyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztnQkFFYixJQUFNLENBQUMsR0FBRyxJQUFJLHVCQUFZLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ2hDLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO2dCQUViLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztnQkFFbkIsYUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ2pDLGFBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsR0FBRyxDQUFDLENBQUM7Z0JBRTNDLGFBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNqQyxhQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxRQUFR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Q3hCLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO2dCQUViLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFFdEIsYUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3RELGFBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDMUIsYUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUMxQixhQUFNLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDdkMsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiB0c2xpbnQ6ZGlzYWJsZTpxdW90ZW1hcmsgKi9cblxuaW1wb3J0IHthc3NlcnR9IGZyb20gJ2NoYWknO1xuaW1wb3J0IHtEYXRhRmxvd05vZGV9IGZyb20gJy4uLy4uLy4uL3NyYy9jb21waWxlL2RhdGEvZGF0YWZsb3cnO1xuXG5kZXNjcmliZSgnY29tcGlsZS9kYXRhL2RhdGFmbG93JywgZnVuY3Rpb24oKSB7XG4gIGRlc2NyaWJlKCdEYXRhRmxvd05vZGUnLCBmdW5jdGlvbigpIHtcbiAgICBkZXNjcmliZSgnc3dhcCcsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgY29ycmVjdGx5IHN3YXAgdHdvIG5vZGVzIGluIGEgc2ltcGxlIGNoYWluJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IGEgPSBuZXcgRGF0YUZsb3dOb2RlKCdhJyk7XG4gICAgICAgIGNvbnN0IGIgPSBuZXcgRGF0YUZsb3dOb2RlKCdiJyk7XG4gICAgICAgIGIucGFyZW50ID0gYTtcblxuICAgICAgICBjb25zdCBjID0gbmV3IERhdGFGbG93Tm9kZSgnYycpO1xuICAgICAgICBjLnBhcmVudCA9IGI7XG5cbiAgICAgICAgY29uc3QgZCA9IG5ldyBEYXRhRmxvd05vZGUoJ2QnKTtcbiAgICAgICAgZC5wYXJlbnQgPSBjO1xuXG4gICAgICAgIGMuc3dhcFdpdGhQYXJlbnQoKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoYS5udW1DaGlsZHJlbigpLCAxKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGEuY2hpbGRyZW5bMF0uZGVidWdOYW1lLCAnYycpO1xuXG4gICAgICAgIGFzc2VydC5lcXVhbChiLm51bUNoaWxkcmVuKCksIDEpO1xuICAgICAgICBhc3NlcnQuZXF1YWwoYi5jaGlsZHJlblswXS5kZWJ1Z05hbWUsICdkJyk7XG5cbiAgICAgICAgYXNzZXJ0LmVxdWFsKGMubnVtQ2hpbGRyZW4oKSwgMSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChjLmNoaWxkcmVuWzBdLmRlYnVnTmFtZSwgJ2InKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoZC5udW1DaGlsZHJlbigpLCAwKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGNvcnJlY3RseSBzd2FwIHR3byBub2RlcycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCByb290ID0gbmV3IERhdGFGbG93Tm9kZSgncm9vdCcpO1xuICAgICAgICBjb25zdCBwYXJlbnQgPSBuZXcgRGF0YUZsb3dOb2RlKCdwYXJlbnQnKTtcbiAgICAgICAgcGFyZW50LnBhcmVudCA9IHJvb3Q7XG5cbiAgICAgICAgY29uc3Qgbm9kZSA9IG5ldyBEYXRhRmxvd05vZGUoJ25vZGUnKTtcbiAgICAgICAgbm9kZS5wYXJlbnQgPSBwYXJlbnQ7XG5cbiAgICAgICAgY29uc3QgY2hpbGQxID0gbmV3IERhdGFGbG93Tm9kZSgnY2hpbGQxJyk7XG4gICAgICAgIGNoaWxkMS5wYXJlbnQgPSBub2RlO1xuXG4gICAgICAgIGNvbnN0IGNoaWxkMiA9IG5ldyBEYXRhRmxvd05vZGUoJ2NoaWxkMicpO1xuICAgICAgICBjaGlsZDIucGFyZW50ID0gbm9kZTtcblxuICAgICAgICBjb25zdCBwYXJlbnRDaGlsZDEgPSBuZXcgRGF0YUZsb3dOb2RlKCdwYXJlbnRDaGlsZDEnKTtcbiAgICAgICAgcGFyZW50Q2hpbGQxLnBhcmVudCA9IHBhcmVudDtcblxuICAgICAgICBjb25zdCBwYXJlbnRDaGlsZDIgPSBuZXcgRGF0YUZsb3dOb2RlKCdwYXJlbnRDaGlsZDInKTtcbiAgICAgICAgcGFyZW50Q2hpbGQyLnBhcmVudCA9IHBhcmVudDtcblxuICAgICAgICBub2RlLnN3YXBXaXRoUGFyZW50KCk7XG5cbiAgICAgICAgYXNzZXJ0LmVxdWFsKHJvb3QubnVtQ2hpbGRyZW4oKSwgMSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChyb290LmNoaWxkcmVuWzBdLmRlYnVnTmFtZSwgJ25vZGUnKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKG5vZGUucGFyZW50LmRlYnVnTmFtZSwgJ3Jvb3QnKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwobm9kZS5udW1DaGlsZHJlbigpLCAxKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKG5vZGUuY2hpbGRyZW5bMF0uZGVidWdOYW1lLCAncGFyZW50Jyk7XG4gICAgICAgIGFzc2VydC5lcXVhbChwYXJlbnQucGFyZW50LmRlYnVnTmFtZSwgJ25vZGUnKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwocGFyZW50Lm51bUNoaWxkcmVuKCksIDQpO1xuICAgICAgICBwYXJlbnQuY2hpbGRyZW4uZm9yRWFjaChjID0+IHtcbiAgICAgICAgICBhc3NlcnQuZXF1YWwoYy5udW1DaGlsZHJlbigpLCAwKTtcbiAgICAgICAgICBhc3NlcnQuZXF1YWwoYy5wYXJlbnQuZGVidWdOYW1lLCAncGFyZW50Jyk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgncmVtb3ZlJywgZnVuY3Rpb24oKSB7XG4gICAgICBpdCgnc2hvdWxkIHJlbW92ZSBub2RlIGZyb20gZGF0YWZsb3cnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3QgYSA9IG5ldyBEYXRhRmxvd05vZGUoJ2EnKTtcbiAgICAgICAgY29uc3QgYiA9IG5ldyBEYXRhRmxvd05vZGUoJ2InKTtcbiAgICAgICAgYi5wYXJlbnQgPSBhO1xuXG4gICAgICAgIGNvbnN0IGMgPSBuZXcgRGF0YUZsb3dOb2RlKCdjJyk7XG4gICAgICAgIGMucGFyZW50ID0gYjtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGEuY2hpbGRyZW4sIFtiXSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChiLnBhcmVudCwgYSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChjLnBhcmVudCwgYik7XG5cbiAgICAgICAgYi5yZW1vdmUoKTtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGEuY2hpbGRyZW4sIFtjXSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChjLnBhcmVudCwgYSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdpbnNlcnRBc1BhcmVudE9mJywgZnVuY3Rpb24oKSB7XG4gICAgICBpdCgnc2hvdWxkIGluc2VydCBub2RlIGludG8gZGF0YWZsb3cnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3QgYSA9IG5ldyBEYXRhRmxvd05vZGUoJ2EnKTtcbiAgICAgICAgY29uc3QgYW5vdGhlckNoaWxkID0gbmV3IERhdGFGbG93Tm9kZSgnYScpO1xuICAgICAgICBjb25zdCBiID0gbmV3IERhdGFGbG93Tm9kZSgnYicpO1xuICAgICAgICBjb25zdCBjID0gbmV3IERhdGFGbG93Tm9kZSgnYycpO1xuXG4gICAgICAgIGFub3RoZXJDaGlsZC5wYXJlbnQgPSBhO1xuICAgICAgICBjLnBhcmVudCA9IGE7XG5cbiAgICAgICAgYi5pbnNlcnRBc1BhcmVudE9mKGMpO1xuXG4gICAgICAgIGFzc2VydC5zYW1lRGVlcE1lbWJlcnMoYS5jaGlsZHJlbiwgW2Fub3RoZXJDaGlsZCwgYl0pO1xuICAgICAgICBhc3NlcnQuZXF1YWwoYi5wYXJlbnQsIGEpO1xuICAgICAgICBhc3NlcnQuZXF1YWwoYy5wYXJlbnQsIGIpO1xuICAgICAgICBhc3NlcnQuZXF1YWwoYW5vdGhlckNoaWxkLnBhcmVudCwgYSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==