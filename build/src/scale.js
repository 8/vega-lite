import * as tslib_1 from "tslib";
import { toSet } from 'vega-util';
import { Channel, isColorChannel } from './channel';
import * as log from './log';
import { contains, flagKeys, keys } from './util';
export var ScaleType;
(function (ScaleType) {
    // Continuous - Quantitative
    ScaleType.LINEAR = 'linear';
    ScaleType.BIN_LINEAR = 'bin-linear';
    ScaleType.LOG = 'log';
    ScaleType.POW = 'pow';
    ScaleType.SQRT = 'sqrt';
    // Continuous - Time
    ScaleType.TIME = 'time';
    ScaleType.UTC = 'utc';
    // sequential
    ScaleType.SEQUENTIAL = 'sequential';
    // Quantile, Quantize, threshold
    ScaleType.QUANTILE = 'quantile';
    ScaleType.QUANTIZE = 'quantize';
    ScaleType.THRESHOLD = 'threshold';
    ScaleType.ORDINAL = 'ordinal';
    ScaleType.BIN_ORDINAL = 'bin-ordinal';
    ScaleType.POINT = 'point';
    ScaleType.BAND = 'band';
})(ScaleType || (ScaleType = {}));
/**
 * Index for scale categories -- only scale of the same categories can be merged together.
 * Current implementation is trying to be conservative and avoid merging scale type that might not work together
 */
var SCALE_CATEGORY_INDEX = {
    linear: 'numeric',
    log: 'numeric',
    pow: 'numeric',
    sqrt: 'numeric',
    'bin-linear': 'bin-linear',
    time: 'time',
    utc: 'time',
    sequential: 'sequential',
    ordinal: 'ordinal',
    'bin-ordinal': 'bin-ordinal',
    point: 'ordinal-position',
    band: 'ordinal-position'
};
export var SCALE_TYPES = keys(SCALE_CATEGORY_INDEX);
/**
 * Whether the two given scale types can be merged together.
 */
export function scaleCompatible(scaleType1, scaleType2) {
    var scaleCategory1 = SCALE_CATEGORY_INDEX[scaleType1];
    var scaleCategory2 = SCALE_CATEGORY_INDEX[scaleType2];
    return scaleCategory1 === scaleCategory2 ||
        (scaleCategory1 === 'ordinal-position' && scaleCategory2 === 'time') ||
        (scaleCategory2 === 'ordinal-position' && scaleCategory1 === 'time');
}
/**
 * Index for scale precedence -- high score = higher priority for merging.
 */
var SCALE_PRECEDENCE_INDEX = {
    // numeric
    linear: 0,
    log: 1,
    pow: 1,
    sqrt: 1,
    // time
    time: 0,
    utc: 0,
    // ordinal-position -- these have higher precedence than continuous scales as they support more types of data
    point: 10,
    band: 11,
    // non grouped types
    'bin-linear': 0,
    sequential: 0,
    ordinal: 0,
    'bin-ordinal': 0,
};
/**
 * Return scale categories -- only scale of the same categories can be merged together.
 */
export function scaleTypePrecedence(scaleType) {
    return SCALE_PRECEDENCE_INDEX[scaleType];
}
export var CONTINUOUS_TO_CONTINUOUS_SCALES = ['linear', 'bin-linear', 'log', 'pow', 'sqrt', 'time', 'utc'];
var CONTINUOUS_TO_CONTINUOUS_INDEX = toSet(CONTINUOUS_TO_CONTINUOUS_SCALES);
export var CONTINUOUS_DOMAIN_SCALES = CONTINUOUS_TO_CONTINUOUS_SCALES.concat(['sequential' /* TODO add 'quantile', 'quantize', 'threshold'*/]);
var CONTINUOUS_DOMAIN_INDEX = toSet(CONTINUOUS_DOMAIN_SCALES);
export var DISCRETE_DOMAIN_SCALES = ['ordinal', 'bin-ordinal', 'point', 'band'];
var DISCRETE_DOMAIN_INDEX = toSet(DISCRETE_DOMAIN_SCALES);
var BIN_SCALES_INDEX = toSet(['bin-linear', 'bin-ordinal']);
export var TIME_SCALE_TYPES = ['time', 'utc'];
export function hasDiscreteDomain(type) {
    return type in DISCRETE_DOMAIN_INDEX;
}
export function isBinScale(type) {
    return type in BIN_SCALES_INDEX;
}
export function hasContinuousDomain(type) {
    return type in CONTINUOUS_DOMAIN_INDEX;
}
export function isContinuousToContinuous(type) {
    return type in CONTINUOUS_TO_CONTINUOUS_INDEX;
}
export var defaultScaleConfig = {
    textXRangeStep: 90,
    rangeStep: 21,
    pointPadding: 0.5,
    bandPaddingInner: 0.1,
    facetSpacing: 16,
    minBandSize: 2,
    minFontSize: 8,
    maxFontSize: 40,
    minOpacity: 0.3,
    maxOpacity: 0.8,
    // FIXME: revise if these *can* become ratios of rangeStep
    minSize: 9,
    minStrokeWidth: 1,
    maxStrokeWidth: 4
};
export function isExtendedScheme(scheme) {
    return scheme && !!scheme['name'];
}
export function isSelectionDomain(domain) {
    return domain && domain['selection'];
}
var SCALE_PROPERTY_INDEX = {
    type: 1,
    domain: 1,
    range: 1,
    rangeStep: 1,
    scheme: 1,
    // Other properties
    reverse: 1,
    round: 1,
    // quantitative / time
    clamp: 1,
    nice: 1,
    // quantitative
    base: 1,
    exponent: 1,
    interpolate: 1,
    zero: 1,
    // band/point
    padding: 1,
    paddingInner: 1,
    paddingOuter: 1
};
export var SCALE_PROPERTIES = flagKeys(SCALE_PROPERTY_INDEX);
var type = SCALE_PROPERTY_INDEX.type, domain = SCALE_PROPERTY_INDEX.domain, range = SCALE_PROPERTY_INDEX.range, rangeStep = SCALE_PROPERTY_INDEX.rangeStep, scheme = SCALE_PROPERTY_INDEX.scheme, NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX = tslib_1.__rest(SCALE_PROPERTY_INDEX, ["type", "domain", "range", "rangeStep", "scheme"]);
export var NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES = flagKeys(NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX);
export function scaleTypeSupportProperty(scaleType, propName) {
    switch (propName) {
        case 'type':
        case 'domain':
        case 'reverse':
        case 'range':
            return true;
        case 'scheme':
            return contains(['sequential', 'ordinal', 'bin-ordinal', 'quantile', 'quantize'], scaleType);
        case 'interpolate':
            // FIXME(https://github.com/vega/vega-lite/issues/2902) how about ordinal?
            return contains(['linear', 'bin-linear', 'pow', 'log', 'sqrt', 'utc', 'time'], scaleType);
        case 'round':
            return isContinuousToContinuous(scaleType) || scaleType === 'band' || scaleType === 'point';
        case 'padding':
            return isContinuousToContinuous(scaleType) || contains(['point', 'band'], scaleType);
        case 'paddingOuter':
        case 'rangeStep':
            return contains(['point', 'band'], scaleType);
        case 'paddingInner':
            return scaleType === 'band';
        case 'clamp':
            return isContinuousToContinuous(scaleType) || scaleType === 'sequential';
        case 'nice':
            return isContinuousToContinuous(scaleType) || scaleType === 'sequential' || scaleType === 'quantize';
        case 'exponent':
            return scaleType === 'pow';
        case 'base':
            return scaleType === 'log';
        case 'zero':
            return hasContinuousDomain(scaleType) && !contains([
                'log',
                'time', 'utc',
                'bin-linear',
                'threshold',
                'quantile' // quantile depends on distribution so zero does not matter
            ], scaleType);
    }
    /* istanbul ignore next: should never reach here*/
    throw new Error("Invalid scale property " + propName + ".");
}
/**
 * Returns undefined if the input channel supports the input scale property name
 */
export function channelScalePropertyIncompatability(channel, propName) {
    switch (propName) {
        case 'interpolate':
        case 'scheme':
            if (!isColorChannel(channel)) {
                return log.message.cannotUseScalePropertyWithNonColor(channel);
            }
            return undefined;
        case 'type':
        case 'domain':
        case 'range':
        case 'base':
        case 'exponent':
        case 'nice':
        case 'padding':
        case 'paddingInner':
        case 'paddingOuter':
        case 'rangeStep':
        case 'reverse':
        case 'round':
        case 'clamp':
        case 'zero':
            return undefined; // GOOD!
    }
    /* istanbul ignore next: it should never reach here */
    throw new Error("Invalid scale property \"" + propName + "\".");
}
export function channelSupportScaleType(channel, scaleType) {
    switch (channel) {
        case Channel.X:
        case Channel.Y:
        case Channel.SIZE: // TODO: size and opacity can support ordinal with more modification
        case Channel.OPACITY:
            // Although it generally doesn't make sense to use band with size and opacity,
            // it can also work since we use band: 0.5 to get midpoint.
            return isContinuousToContinuous(scaleType) || contains(['band', 'point'], scaleType);
        case Channel.COLOR:
        case Channel.FILL:
        case Channel.STROKE:
            return scaleType !== 'band'; // band does not make sense with color
        case Channel.SHAPE:
            return scaleType === 'ordinal'; // shape = lookup only
    }
    /* istanbul ignore next: it should never reach here */
    return false;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NhbGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2NhbGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxLQUFLLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDaEMsT0FBTyxFQUFDLE9BQU8sRUFBRSxjQUFjLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFFbEQsT0FBTyxLQUFLLEdBQUcsTUFBTSxPQUFPLENBQUM7QUFDN0IsT0FBTyxFQUFDLFFBQVEsRUFBUSxRQUFRLEVBQUUsSUFBSSxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBR3RELE1BQU0sS0FBVyxTQUFTLENBc0J6QjtBQXRCRCxXQUFpQixTQUFTO0lBQ3hCLDRCQUE0QjtJQUNmLGdCQUFNLEdBQWEsUUFBUSxDQUFDO0lBQzVCLG9CQUFVLEdBQWlCLFlBQVksQ0FBQztJQUN4QyxhQUFHLEdBQVUsS0FBSyxDQUFDO0lBQ25CLGFBQUcsR0FBVSxLQUFLLENBQUM7SUFDbkIsY0FBSSxHQUFXLE1BQU0sQ0FBQztJQUNuQyxvQkFBb0I7SUFDUCxjQUFJLEdBQVcsTUFBTSxDQUFDO0lBQ3RCLGFBQUcsR0FBVSxLQUFLLENBQUM7SUFDaEMsYUFBYTtJQUNBLG9CQUFVLEdBQWlCLFlBQVksQ0FBQztJQUVyRCxnQ0FBZ0M7SUFDbkIsa0JBQVEsR0FBZSxVQUFVLENBQUM7SUFDbEMsa0JBQVEsR0FBZSxVQUFVLENBQUM7SUFDbEMsbUJBQVMsR0FBZ0IsV0FBVyxDQUFDO0lBRXJDLGlCQUFPLEdBQWMsU0FBUyxDQUFDO0lBQy9CLHFCQUFXLEdBQWtCLGFBQWEsQ0FBQztJQUMzQyxlQUFLLEdBQVksT0FBTyxDQUFDO0lBQ3pCLGNBQUksR0FBVyxNQUFNLENBQUM7QUFDckMsQ0FBQyxFQXRCZ0IsU0FBUyxLQUFULFNBQVMsUUFzQnpCO0FBVUQ7OztHQUdHO0FBQ0gsSUFBTSxvQkFBb0IsR0FHdEI7SUFDRixNQUFNLEVBQUUsU0FBUztJQUNqQixHQUFHLEVBQUUsU0FB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Z2EtdXRpbCc7XG5pbXBvcnQge0NoYW5uZWwsIGlzQ29sb3JDaGFubmVsfSBmcm9tICcuL2NoYW5uZWwnO1xuaW1wb3J0IHtEYXRlVGltZX0gZnJvbSAnLi9kYXRldGltZSc7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtjb250YWlucywgRmxhZywgZmxhZ0tleXMsIGtleXN9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQge1NjYWxlSW50ZXJwb2xhdGUsIFNjYWxlSW50ZXJwb2xhdGVQYXJhbXN9IGZyb20gJy4vdmVnYS5zY2hlbWEnO1xuXG5leHBvcnQgbmFtZXNwYWNlIFNjYWxlVHlwZSB7XG4gIC8vIENvbnRpbnVvdXMgLSBRdWFudGl0YXRpdmVcbiAgZXhwb3J0IGNvbnN0IExJTkVBUjogJ2xpbmVhcicgPSAnbGluZWFyJztcbiAgZXhwb3J0IGNvbnN0IEJJTl9MSU5FQVI6ICdiaW4tbGluZWFyJyA9ICdiaW4tbGluZWFyJztcbiAgZXhwb3J0IGNvbnN0IExPRzogJ2xvZycgPSAnbG9nJztcbiAgZXhwb3J0IGNvbnN0IFBPVzogJ3BvdycgPSAncG93JztcbiAgZXhwb3J0IGNvbnN0IFNRUlQ6ICdzcXJ0JyA9ICdzcXJ0JztcbiAgLy8gQ29udGludW91cyAtIFRpbWVcbiAgZXhwb3J0IGNvbnN0IFRJTUU6ICd0aW1lJyA9ICd0aW1lJztcbiAgZXhwb3J0IGNvbnN0IFVUQzogJ3V0YycgPSAndXRjJztcbiAgLy8gc2VxdWVudGlhbFxuICBleHBvcnQgY29uc3QgU0VRVUVOVElBTDogJ3NlcXVlbnRpYWwnID0gJ3NlcXVlbnRpYWwnO1xuXG4gIC8vIFF1YW50aWxlLCBRdWFudGl6ZSwgdGhyZXNob2xkXG4gIGV4cG9ydCBjb25zdCBRVUFOVElMRTogJ3F1YW50aWxlJyA9ICdxdWFudGlsZSc7XG4gIGV4cG9ydCBjb25zdCBRVUFOVElaRTogJ3F1YW50aXplJyA9ICdxdWFudGl6ZSc7XG4gIGV4cG9ydCBjb25zdCBUSFJFU0hPTEQ6ICd0aHJlc2hvbGQnID0gJ3RocmVzaG9sZCc7XG5cbiAgZXhwb3J0IGNvbnN0IE9SRElOQUw6ICdvcmRpbmFsJyA9ICdvcmRpbmFsJztcbiAgZXhwb3J0IGNvbnN0IEJJTl9PUkRJTkFMOiAnYmluLW9yZGluYWwnID0gJ2Jpbi1vcmRpbmFsJztcbiAgZXhwb3J0IGNvbnN0IFBPSU5UOiAncG9pbnQnID0gJ3BvaW50JztcbiAgZXhwb3J0IGNvbnN0IEJBTkQ6ICdiYW5kJyA9ICdiYW5kJztcbn1cblxuZXhwb3J0IHR5cGUgU2NhbGVUeXBlID0gdHlwZW9mIFNjYWxlVHlwZS5MSU5FQVIgfCB0eXBlb2YgU2NhbGVUeXBlLkJJTl9MSU5FQVIgfFxuICB0eXBlb2YgU2NhbGVUeXBlLkxPRyB8IHR5cGVvZiBTY2FsZVR5cGUuUE9XIHwgdHlwZW9mIFNjYWxlVHlwZS5TUVJUIHxcbiAgdHlwZW9mIFNjYWxlVHlwZS5USU1FIHwgdHlwZW9mIFNjYWxlVHlwZS5VVEMgfFxuICAvLyBUT0RPOiBhZGQgJ3F1YW50aXplJywgJ3F1YW50aWxlJywgJ3RocmVzaG9sZCcgYmFjayB3aGVuIHdlIHJlYWxseSBzdXBwb3J0IHRoZW1cbiAgdHlwZW9mIFNjYWxlVHlwZS5TRVFVRU5USUFMIHwgLy8gdHlwZW9mIFNjYWxlVHlwZS5RVUFOVElMRSB8IHR5cGVvZiBTY2FsZVR5cGUuUVVBTlRJWkUgfCB0eXBlb2YgU2NhbGVUeXBlLlRIUkVTSE9MRCB8XG4gIHR5cGVvZiBTY2FsZVR5cGUuT1JESU5BTCB8IHR5cGVvZiBTY2FsZVR5cGUuQklOX09SRElOQUwgfCB0eXBlb2YgU2NhbGVUeXBlLlBPSU5UIHwgdHlwZW9mIFNjYWxlVHlwZS5CQU5EO1xuXG5cbi8qKlxuICogSW5kZXggZm9yIHNjYWxlIGNhdGVnb3JpZXMgLS0gb25seSBzY2FsZSBvZiB0aGUgc2FtZSBjYXRlZ29yaWVzIGNhbiBiZSBtZXJnZWQgdG9nZXRoZXIuXG4gKiBDdXJyZW50IGltcGxlbWVudGF0aW9uIGlzIHRyeWluZyB0byBiZSBjb25zZXJ2YXRpdmUgYW5kIGF2b2lkIG1lcmdpbmcgc2NhbGUgdHlwZSB0aGF0IG1pZ2h0IG5vdCB3b3JrIHRvZ2V0aGVyXG4gKi9cbmNvbnN0IFNDQUxFX0NBVEVHT1JZX0lOREVYOiB7XG4gIC8vIFVzaW5nIE1hcHBlZCBUeXBlIHRvIGRlY2xhcmUgdHlwZSAoaHR0cHM6Ly93d3cudHlwZXNjcmlwdGxhbmcub3JnL2RvY3MvaGFuZGJvb2svYWR2YW5jZWQtdHlwZXMuaHRtbCNtYXBwZWQtdHlwZXMpXG4gIFtrIGluIFNjYWxlVHlwZV06IFNjYWxlVHlwZSB8ICdudW1lcmljJyB8ICdvcmRpbmFsLXBvc2l0aW9uJ1xufSA9IHtcbiAgbGluZWFyOiAnbnVtZXJpYycsXG4gIGxvZzogJ251bWVyaWMnLFxuICBwb3c6ICdudW1lcmljJyxcbiAgc3FydDogJ251bWVyaWMnLFxuICAnYmluLWxpbmVhcic6ICdiaW4tbGluZWFyJywgLy8gVE9ETzogc2hvdWxkIGJpbi1saW5lYXIgc3VwcG9ydCBtZXJnaW5nIHdpdGggb3RoZXJcbiAgdGltZTogJ3RpbWUnLFxuICB1dGM6ICd0aW1lJyxcbiAgc2VxdWVudGlhbDogJ3NlcXVlbnRpYWwnLFxuICBvcmRpbmFsOiAnb3JkaW5hbCcsXG4gICdiaW4tb3JkaW5hbCc6ICdiaW4tb3JkaW5hbCcsIC8vIFRPRE86IHNob3VsZCBiaW4tb3JkaW5hbCBzdXBwb3J0IG1lcmdpbmcgd2l0aCBvdGhlclxuICBwb2ludDogJ29yZGluYWwtcG9zaXRpb24nLFxuICBiYW5kOiAnb3JkaW5hbC1wb3NpdGlvbidcbn07XG5cbmV4cG9ydCBjb25zdCBTQ0FMRV9UWVBFUyA9IGtleXMoU0NBTEVfQ0FURUdPUllfSU5ERVgpIGFzIFNjYWxlVHlwZVtdO1xuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHR3byBnaXZlbiBzY2FsZSB0eXBlcyBjYW4gYmUgbWVyZ2VkIHRvZ2V0aGVyLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NhbGVDb21wYXRpYmxlKHNjYWxlVHlwZTE6IFNjYWxlVHlwZSwgc2NhbGVUeXBlMjogU2NhbGVUeXBlKSB7XG4gIGNvbnN0IHNjYWxlQ2F0ZWdvcnkxID0gU0NBTEVfQ0FURUdPUllfSU5ERVhbc2NhbGVUeXBlMV07XG4gIGNvbnN0IHNjYWxlQ2F0ZWdvcnkyID0gU0NBTEVfQ0FURUdPUllfSU5ERVhbc2NhbGVUeXBlMl07XG4gIHJldHVybiBzY2FsZUNhdGVnb3J5MSA9PT0gc2NhbGVDYXRlZ29yeTIgfHxcbiAgICAoc2NhbGVDYXRlZ29yeTEgPT09ICdvcmRpbmFsLXBvc2l0aW9uJyAmJiBzY2FsZUNhdGVnb3J5MiA9PT0gJ3RpbWUnKSB8fFxuICAgIChzY2FsZUNhdGVnb3J5MiA9PT0gJ29yZGluYWwtcG9zaXRpb24nICYmIHNjYWxlQ2F0ZWdvcnkxID09PSAndGltZScpO1xufVxuXG4vKipcbiAqIEluZGV4IGZvciBzY2FsZSBwcmVjZWRlbmNlIC0tIGhpZ2ggc2NvcmUgPSBoaWdoZXIgcHJpb3JpdHkgZm9yIG1lcmdpbmcuXG4gKi9cbmNvbnN0IFNDQUxFX1BSRUNFREVOQ0VfSU5ERVg6IHtcbiAgLy8gVXNpbmcgTWFwcGVkIFR5cGUgdG8gZGVjbGFyZSB0eXBlIChodHRwczovL3d3dy50eXBlc2NyaXB0bGFuZy5vcmcvZG9jcy9oYW5kYm9vay9hZHZhbmNlZC10eXBlcy5odG1sI21hcHBlZC10eXBlcylcbiAgW2sgaW4gU2NhbGVUeXBlXTogbnVtYmVyXG59ID0ge1xuICAvLyBudW1lcmljXG4gIGxpbmVhcjogMCxcbiAgbG9nOiAxLFxuICBwb3c6IDEsXG4gIHNxcnQ6IDEsXG4gIC8vIHRpbWVcbiAgdGltZTogMCxcbiAgdXRjOiAwLFxuICAvLyBvcmRpbmFsLXBvc2l0aW9uIC0tIHRoZXNlIGhhdmUgaGlnaGVyIHByZWNlZGVuY2UgdGhhbiBjb250aW51b3VzIHNjYWxlcyBhcyB0aGV5IHN1cHBvcnQgbW9yZSB0eXBlcyBvZiBkYXRhXG4gIHBvaW50OiAxMCxcbiAgYmFuZDogMTEsIC8vIGJhbmQgaGFzIGhpZ2hlciBwcmVjZWRlbmNlIGFzIGl0IGlzIGJldHRlciBmb3IgaW50ZXJhY3Rpb25cbiAgLy8gbm9uIGdyb3VwZWQgdHlwZXNcbiAgJ2Jpbi1saW5lYXInOiAwLFxuICBzZXF1ZW50aWFsOiAwLFxuICBvcmRpbmFsOiAwLFxuICAnYmluLW9yZGluYWwnOiAwLFxufTtcblxuLyoqXG4gKiBSZXR1cm4gc2NhbGUgY2F0ZWdvcmllcyAtLSBvbmx5IHNjYWxlIG9mIHRoZSBzYW1lIGNhdGVnb3JpZXMgY2FuIGJlIG1lcmdlZCB0b2dldGhlci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjYWxlVHlwZVByZWNlZGVuY2Uoc2NhbGVUeXBlOiBTY2FsZVR5cGUpOiBudW1iZXIge1xuICByZXR1cm4gU0NBTEVfUFJFQ0VERU5DRV9JTkRFWFtzY2FsZVR5cGVdO1xufVxuXG5leHBvcnQgY29uc3QgQ09OVElOVU9VU19UT19DT05USU5VT1VTX1NDQUxFUzogU2NhbGVUeXBlW10gPSBbJ2xpbmVhcicsICdiaW4tbGluZWFyJywgJ2xvZycsICdwb3cnLCAnc3FydCcsICd0aW1lJywgJ3V0YyddO1xuY29uc3QgQ09OVElOVU9VU19UT19DT05USU5VT1VTX0lOREVYID0gdG9TZXQoQ09OVElOVU9VU19UT19DT05USU5VT1VTX1NDQUxFUyk7XG5cbmV4cG9ydCBjb25zdCBDT05USU5VT1VTX0RPTUFJTl9TQ0FMRVM6IFNjYWxlVHlwZVtdID0gQ09OVElOVU9VU19UT19DT05USU5VT1VTX1NDQUxFUy5jb25jYXQoWydzZXF1ZW50aWFsJyAvKiBUT0RPIGFkZCAncXVhbnRpbGUnLCAncXVhbnRpemUnLCAndGhyZXNob2xkJyovXSk7XG5jb25zdCBDT05USU5VT1VTX0RPTUFJTl9JTkRFWCA9IHRvU2V0KENPTlRJTlVPVVNfRE9NQUlOX1NDQUxFUyk7XG5cbmV4cG9ydCBjb25zdCBESVNDUkVURV9ET01BSU5fU0NBTEVTOiBTY2FsZVR5cGVbXSA9IFsnb3JkaW5hbCcsICdiaW4tb3JkaW5hbCcsICdwb2ludCcsICdiYW5kJ107XG5jb25zdCBESVNDUkVURV9ET01BSU5fSU5ERVggPSB0b1NldChESVNDUkVURV9ET01BSU5fU0NBTEVTKTtcblxuY29uc3QgQklOX1NDQUxFU19JTkRFWCA9IHRvU2V0KFsnYmluLWxpbmVhcicsICdiaW4tb3JkaW5hbCddKTtcblxuZXhwb3J0IGNvbnN0IFRJTUVfU0NBTEVfVFlQRVM6IFNjYWxlVHlwZVtdID0gWyd0aW1lJywgJ3V0YyddO1xuXG5leHBvcnQgZnVuY3Rpb24gaGFzRGlzY3JldGVEb21haW4odHlwZTogU2NhbGVUeXBlKTogdHlwZSBpcyAnb3JkaW5hbCcgfCAnYmluLW9yZGluYWwnIHwgJ3BvaW50JyB8ICdiYW5kJyB7XG4gIHJldHVybiB0eXBlIGluIERJU0NSRVRFX0RPTUFJTl9JTkRFWDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQmluU2NhbGUodHlwZTogU2NhbGVUeXBlKTogdHlwZSBpcyAnYmluLWxpbmVhcicgfCAnYmluLW9yZGluYWwnIHtcbiAgcmV0dXJuIHR5cGUgaW4gQklOX1NDQUxFU19JTkRFWDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc0NvbnRpbnVvdXNEb21haW4odHlwZTogU2NhbGVUeXBlKTpcbiAgdHlwZSBpcyAnbGluZWFyJyB8ICdsb2cnIHwgJ3BvdycgfCAnc3FydCcgfCAndGltZScgfCAndXRjJ3xcbiAgICAgICAgICAnc2VxdWVudGlhbCcgLyogVE9ETyBhZGQgfCAncXVhbnRpbGUnIHwgJ3F1YW50aXplJyB8ICd0aHJlc2hvbGQnICovIHtcbiAgcmV0dXJuIHR5cGUgaW4gQ09OVElOVU9VU19ET01BSU5fSU5ERVg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbnRpbnVvdXNUb0NvbnRpbnVvdXModHlwZTogU2NhbGVUeXBlKTogdHlwZSBpcyAnbGluZWFyJyB8ICdiaW4tbGluZWFyJyB8ICdsb2cnIHwgJ3BvdycgfCAnc3FydCcgfCAndGltZScgfCAndXRjJyB7XG4gIHJldHVybiB0eXBlIGluIENPTlRJTlVPVVNfVE9fQ09OVElOVU9VU19JTkRFWDtcbn1cblxuZXhwb3J0IHR5cGUgTmljZVRpbWUgPSAnc2Vjb25kJyB8ICdtaW51dGUnIHwgJ2hvdXInIHwgJ2RheScgfCAnd2VlaycgfCAnbW9udGgnIHwgJ3llYXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNjYWxlQ29uZmlnIHtcbiAgLyoqXG4gICAqIElmIHRydWUsIHJvdW5kcyBudW1lcmljIG91dHB1dCB2YWx1ZXMgdG8gaW50ZWdlcnMuXG4gICAqIFRoaXMgY2FuIGJlIGhlbHBmdWwgZm9yIHNuYXBwaW5nIHRvIHRoZSBwaXhlbCBncmlkLlxuICAgKiAoT25seSBhdmFpbGFibGUgZm9yIGB4YCwgYHlgLCBhbmQgYHNpemVgIHNjYWxlcy4pXG4gICAqL1xuICByb3VuZD86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIElmIHRydWUsIHZhbHVlcyB0aGF0IGV4Y2VlZCB0aGUgZGF0YSBkb21haW4gYXJlIGNsYW1wZWQgdG8gZWl0aGVyIHRoZSBtaW5pbXVtIG9yIG1heGltdW0gcmFuZ2UgdmFsdWVcbiAgICovXG4gIGNsYW1wPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqICBEZWZhdWx0IHJhbmdlIHN0ZXAgZm9yIGB4YCBiYW5kIGFuZCBwb2ludCBzY2FsZXMgb2YgdGV4dCBtYXJrcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGA5MGBcbiAgICpcbiAgICogIEBtaW5pbXVtIDBcbiAgICovXG4gIHRleHRYUmFuZ2VTdGVwPzogbnVtYmVyOyAvLyBGSVhNRTogY29uc2lkZXIgaWYgd2Ugd2lsbCByZW5hbWUgdGhpcyBcInRhYmxlQ29sdW1uV2lkdGhcIlxuXG4gIC8qKlxuICAgKiBEZWZhdWx0IHJhbmdlIHN0ZXAgZm9yIGJhbmQgYW5kIHBvaW50IHNjYWxlcyBvZiAoMSkgdGhlIGB5YCBjaGFubmVsXG4gICAqIGFuZCAoMikgdGhlIGB4YCBjaGFubmVsIHdoZW4gdGhlIG1hcmsgaXMgbm90IGB0ZXh0YC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAyMWBcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgcmFuZ2VTdGVwPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogRGVmYXVsdCBpbm5lciBwYWRkaW5nIGZvciBgeGAgYW5kIGB5YCBiYW5kLW9yZGluYWwgc2NhbGVzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDAuMWBcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBiYW5kUGFkZGluZ0lubmVyPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG91dGVyIHBhZGRpbmcgZm9yIGB4YCBhbmQgYHlgIGJhbmQtb3JkaW5hbCBzY2FsZXMuXG4gICAqIElmIG5vdCBzcGVjaWZpZWQsIGJ5IGRlZmF1bHQsIGJhbmQgc2NhbGUncyBwYWRkaW5nT3V0ZXIgaXMgcGFkZGluZ0lubmVyLzIuXG4gICAqIEBtaW5pbXVtIDBcbiAgICogQG1heGltdW0gMVxuICAgKi9cbiAgYmFuZFBhZGRpbmdPdXRlcj86IG51bWJlcjtcblxuICAvKipcbiAgICogRGVmYXVsdCBwYWRkaW5nIGZvciBjb250aW51b3VzIHNjYWxlcy5cbiAgICpcbiAgICogX19EZWZhdWx0Ol9fIGA1YCBmb3IgY29udGludW91cyB4LXNjYWxlIG9mIGEgdmVydGljYWwgYmFyIGFuZCBjb250aW51b3VzIHktc2NhbGUgb2YgYSBob3Jpem9udGFsIGJhci47IGAwYCBvdGhlcndpc2UuXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIGNvbnRpbnVvdXNQYWRkaW5nPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG91dGVyIHBhZGRpbmcgZm9yIGB4YCBhbmQgYHlgIHBvaW50LW9yZGluYWwgc2NhbGVzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDAuNWBcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBwb2ludFBhZGRpbmc/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFVzZSB0aGUgc291cmNlIGRhdGEgcmFuZ2UgYmVmb3JlIGFnZ3JlZ2F0aW9uIGFzIHNjYWxlIGRvbWFpbiBpbnN0ZWFkIG9mIGFnZ3JlZ2F0ZWQgZGF0YSBmb3IgYWdncmVnYXRlIGF4aXMuXG4gICAqXG4gICAqIFRoaXMgaXMgZXF1aXZhbGVudCB0byBzZXR0aW5nIGBkb21haW5gIHRvIGBcInVuYWdncmVnYXRlXCJgIGZvciBhZ2dyZWdhdGVkIF9xdWFudGl0YXRpdmVfIGZpZWxkcyBieSBkZWZhdWx0LlxuICAgKlxuICAgKiBUaGlzIHByb3BlcnR5IG9ubHkgd29ya3Mgd2l0aCBhZ2dyZWdhdGUgZnVuY3Rpb25zIHRoYXQgcHJvZHVjZSB2YWx1ZXMgd2l0aGluIHRoZSByYXcgZGF0YSBkb21haW4gKGBcIm1lYW5cImAsIGBcImF2ZXJhZ2VcImAsIGBcIm1lZGlhblwiYCwgYFwicTFcImAsIGBcInEzXCJgLCBgXCJtaW5cImAsIGBcIm1heFwiYCkuIEZvciBvdGhlciBhZ2dyZWdhdGlvbnMgdGhhdCBwcm9kdWNlIHZhbHVlcyBvdXRzaWRlIG9mIHRoZSByYXcgZGF0YSBkb21haW4gKGUuZy4gYFwiY291bnRcImAsIGBcInN1bVwiYCksIHRoaXMgcHJvcGVydHkgaXMgaWdub3JlZC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBmYWxzZWBcbiAgICovXG4gIHVzZVVuYWdncmVnYXRlZERvbWFpbj86IGJvb2xlYW47XG5cbiAgLy8gbmljZSBzaG91bGQgZGVwZW5kcyBvbiB0eXBlIChxdWFudGl0YXRpdmUgb3IgdGVtcG9yYWwpLCBzb1xuICAvLyBsZXQncyBub3QgbWFrZSBhIGNvbmZpZy5cblxuICAvLyBDb25maWdzIGZvciBSYW5nZVxuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBtYXggdmFsdWUgZm9yIG1hcHBpbmcgcXVhbnRpdGF0aXZlIGZpZWxkcyB0byBiYXIncyBzaXplL2JhbmRTaXplLlxuICAgKlxuICAgKiBJZiB1bmRlZmluZWQgKGRlZmF1bHQpLCB3ZSB3aWxsIHVzZSB0aGUgc2NhbGUncyBgcmFuZ2VTdGVwYCAtIDEuXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1heEJhbmRTaXplPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBtaW4gdmFsdWUgZm9yIG1hcHBpbmcgcXVhbnRpdGF0aXZlIGZpZWxkcyB0byBiYXIgYW5kIHRpY2sncyBzaXplL2JhbmRTaXplIHNjYWxlIHdpdGggemVybz1mYWxzZS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAyYFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtaW5CYW5kU2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGRlZmF1bHQgbWF4IHZhbHVlIGZvciBtYXBwaW5nIHF1YW50aXRhdGl2ZSBmaWVsZHMgdG8gdGV4dCdzIHNpemUvZm9udFNpemUuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgNDBgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1heEZvbnRTaXplPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBtaW4gdmFsdWUgZm9yIG1hcHBpbmcgcXVhbnRpdGF0aXZlIGZpZWxkcyB0byB0aWNrJ3Mgc2l6ZS9mb250U2l6ZSBzY2FsZSB3aXRoIHplcm89ZmFsc2VcbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGA4YFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtaW5Gb250U2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogRGVmYXVsdCBtaW5pbXVtIG9wYWNpdHkgZm9yIG1hcHBpbmcgYSBmaWVsZCB0byBvcGFjaXR5LlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDAuM2BcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBtaW5PcGFjaXR5PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1heCBvcGFjaXR5IGZvciBtYXBwaW5nIGEgZmllbGQgdG8gb3BhY2l0eS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAwLjhgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICogQG1heGltdW0gMVxuICAgKi9cbiAgbWF4T3BhY2l0eT86IG51bWJlcjtcblxuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1pbmltdW0gdmFsdWUgZm9yIHBvaW50IHNpemUgc2NhbGUgd2l0aCB6ZXJvPWZhbHNlLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDlgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1pblNpemU/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgbWF4IHZhbHVlIGZvciBwb2ludCBzaXplIHNjYWxlLlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtYXhTaXplPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1pbmltdW0gc3Ryb2tlV2lkdGggZm9yIHRoZSBzY2FsZSBvZiBzdHJva2VXaWR0aCBmb3IgcnVsZSBhbmQgbGluZSBtYXJrcyBhbmQgb2Ygc2l6ZSBmb3IgdHJhaWwgbWFya3Mgd2l0aCB6ZXJvPWZhbHNlLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDFgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1pblN0cm9rZVdpZHRoPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1heCBzdHJva2VXaWR0aCBmb3IgdGhlIHNjYWxlIG9mIHN0cm9rZVdpZHRoIGZvciBydWxlIGFuZCBsaW5lIG1hcmtzIGFuZCBvZiBzaXplIGZvciB0cmFpbCBtYXJrcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGA0YFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtYXhTdHJva2VXaWR0aD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRTY2FsZUNvbmZpZyA9IHtcbiAgdGV4dFhSYW5nZVN0ZXA6IDkwLFxuICByYW5nZVN0ZXA6IDIxLFxuICBwb2ludFBhZGRpbmc6IDAuNSxcbiAgYmFuZFBhZGRpbmdJbm5lcjogMC4xLFxuICBmYWNldFNwYWNpbmc6IDE2LFxuXG4gIG1pbkJhbmRTaXplOiAyLFxuXG4gIG1pbkZvbnRTaXplOiA4LFxuICBtYXhGb250U2l6ZTogNDAsXG5cbiAgbWluT3BhY2l0eTogMC4zLFxuICBtYXhPcGFjaXR5OiAwLjgsXG5cbiAgLy8gRklYTUU6IHJldmlzZSBpZiB0aGVzZSAqY2FuKiBiZWNvbWUgcmF0aW9zIG9mIHJhbmdlU3RlcFxuICBtaW5TaXplOiA5LCAvLyBQb2ludCBzaXplIGlzIGFyZWEuIEZvciBzcXVhcmUgcG9pbnQsIDkgPSAzIHBpeGVsIF4gMiwgbm90IHRvbyBzbWFsbCFcblxuICBtaW5TdHJva2VXaWR0aDogMSxcbiAgbWF4U3Ryb2tlV2lkdGg6IDRcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NoZW1lUGFyYW1zIHtcbiAgLyoqXG4gICAqIEEgY29sb3Igc2NoZW1lIG5hbWUgZm9yIHNlcXVlbnRpYWwvb3JkaW5hbCBzY2FsZXMgKGUuZy4sIGBcImNhdGVnb3J5MTBcImAgb3IgYFwidmlyaWRpc1wiYCkuXG4gICAqXG4gICAqIEZvciB0aGUgZnVsbCBsaXN0IG9mIHN1cHBvcnRlZCBzY2hlbWVzLCBwbGVhc2UgcmVmZXIgdG8gdGhlIFtWZWdhIFNjaGVtZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhL2RvY3Mvc2NoZW1lcy8jcmVmZXJlbmNlKSByZWZlcmVuY2UuXG4gICAqL1xuICBuYW1lOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEZvciBzZXF1ZW50aWFsIGFuZCBkaXZlcmdpbmcgc2NoZW1lcyBvbmx5LCBkZXRlcm1pbmVzIHRoZSBleHRlbnQgb2YgdGhlIGNvbG9yIHJhbmdlIHRvIHVzZS4gRm9yIGV4YW1wbGUgYFswLjIsIDFdYCB3aWxsIHJlc2NhbGUgdGhlIGNvbG9yIHNjaGVtZSBzdWNoIHRoYXQgY29sb3IgdmFsdWVzIGluIHRoZSByYW5nZSBfWzAsIDAuMilfIGFyZSBleGNsdWRlZCBmcm9tIHRoZSBzY2hlbWUuXG4gICAqL1xuICBleHRlbnQ/OiBudW1iZXJbXTtcblxuICAvKipcbiAgICogVGhlIG51bWJlciBvZiBjb2xvcnMgdG8gdXNlIGluIHRoZSBzY2hlbWUuIFRoaXMgY2FuIGJlIHVzZWZ1bCBmb3Igc2NhbGUgdHlwZXMgc3VjaCBhcyBgXCJxdWFudGl6ZVwiYCwgd2hpY2ggdXNlIHRoZSBsZW5ndGggb2YgdGhlIHNjYWxlIHJhbmdlIHRvIGRldGVybWluZSB0aGUgbnVtYmVyIG9mIGRpc2NyZXRlIGJpbnMgZm9yIHRoZSBzY2FsZSBkb21haW4uXG4gICAqXG4gICAqIEBoaWRlXG4gICAqL1xuICBjb3VudD86IG51bWJlcjtcbn1cblxuZXhwb3J0IHR5cGUgU2VsZWN0aW9uRG9tYWluID0ge1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgYSBzZWxlY3Rpb24uXG4gICAqL1xuICBzZWxlY3Rpb246IHN0cmluZyxcbiAgLyoqXG4gICAqIFRoZSBmaWVsZCBuYW1lIHRvIGV4dHJhY3Qgc2VsZWN0ZWQgdmFsdWVzIGZvciwgd2hlbiBhIHNlbGVjdGlvbiBpcyBbcHJvamVjdGVkXShwcm9qZWN0Lmh0bWwpXG4gICAqIG92ZXIgbXVsdGlwbGUgZmllbGRzIG9yIGVuY29kaW5ncy5cbiAgICovXG4gIGZpZWxkPzogc3RyaW5nXG59IHwge1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgYSBzZWxlY3Rpb24uXG4gICAqL1xuICBzZWxlY3Rpb246IHN0cmluZyxcbiAgLyoqXG4gICAqIFRoZSBlbmNvZGluZyBjaGFubmVsIHRvIGV4dHJhY3Qgc2VsZWN0ZWQgdmFsdWVzIGZvciwgd2hlbiBhIHNlbGVjdGlvbiBpcyBbcHJvamVjdGVkXShwcm9qZWN0Lmh0bWwpXG4gICAqIG92ZXIgbXVsdGlwbGUgZmllbGRzIG9yIGVuY29kaW5ncy5cbiAgICovXG4gIGVuY29kaW5nPzogc3RyaW5nXG59O1xuXG5leHBvcnQgdHlwZSBEb21haW4gPSBudW1iZXJbXSB8IHN0cmluZ1tdIHwgYm9vbGVhbltdIHwgRGF0ZVRpbWVbXSB8ICd1bmFnZ3JlZ2F0ZWQnIHwgU2VsZWN0aW9uRG9tYWluO1xuZXhwb3J0IHR5cGUgU2NoZW1lID0gc3RyaW5nIHwgU2NoZW1lUGFyYW1zO1xuXG5leHBvcnQgdHlwZSBSYW5nZSA9IG51bWJlcltdIHwgc3RyaW5nW10gfCBzdHJpbmc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0V4dGVuZGVkU2NoZW1lKHNjaGVtZTogc3RyaW5nIHwgU2NoZW1lUGFyYW1zKTogc2NoZW1lIGlzIFNjaGVtZVBhcmFtcyB7XG4gIHJldHVybiBzY2hlbWUgJiYgISFzY2hlbWVbJ25hbWUnXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU2VsZWN0aW9uRG9tYWluKGRvbWFpbjogRG9tYWluKTogZG9tYWluIGlzIFNlbGVjdGlvbkRvbWFpbiB7XG4gIHJldHVybiBkb21haW4gJiYgZG9tYWluWydzZWxlY3Rpb24nXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTY2FsZSB7XG4gIC8qKlxuICAgKiBUaGUgdHlwZSBvZiBzY2FsZS4gIFZlZ2EtTGl0ZSBzdXBwb3J0cyB0aGUgZm9sbG93aW5nIGNhdGVnb3JpZXMgb2Ygc2NhbGUgdHlwZXM6XG4gICAqXG4gICAqIDEpIFsqKkNvbnRpbnVvdXMgU2NhbGVzKipdKHNjYWxlLmh0bWwjY29udGludW91cykgLS0gbWFwcGluZyBjb250aW51b3VzIGRvbWFpbnMgdG8gY29udGludW91cyBvdXRwdXQgcmFuZ2VzIChbYFwibGluZWFyXCJgXShzY2FsZS5odG1sI2xpbmVhciksIFtgXCJwb3dcImBdKHNjYWxlLmh0bWwjcG93KSwgW2BcInNxcnRcImBdKHNjYWxlLmh0bWwjc3FydCksIFtgXCJsb2dcImBdKHNjYWxlLmh0bWwjbG9nKSwgW2BcInRpbWVcImBdKHNjYWxlLmh0bWwjdGltZSksIFtgXCJ1dGNcImBdKHNjYWxlLmh0bWwjdXRjKSwgW2BcInNlcXVlbnRpYWxcImBdKHNjYWxlLmh0bWwjc2VxdWVudGlhbCkpLlxuICAgKlxuICAgKiAyKSBbKipEaXNjcmV0ZSBTY2FsZXMqKl0oc2NhbGUuaHRtbCNkaXNjcmV0ZSkgLS0gbWFwcGluZyBkaXNjcmV0ZSBkb21haW5zIHRvIGRpc2NyZXRlIChbYFwib3JkaW5hbFwiYF0oc2NhbGUuaHRtbCNvcmRpbmFsKSkgb3IgY29udGludW91cyAoW2BcImJhbmRcImBdKHNjYWxlLmh0bWwjYmFuZCkgYW5kIFtgXCJwb2ludFwiYF0oc2NhbGUuaHRtbCNwb2ludCkpIG91dHB1dCByYW5nZXMuXG4gICAqXG4gICAqIDMpIFsqKkRpc2NyZXRpemluZyBTY2FsZXMqKl0oc2NhbGUuaHRtbCNkaXNjcmV0aXppbmcpIC0tIG1hcHBpbmcgY29udGludW91cyBkb21haW5zIHRvIGRpc2NyZXRlIG91dHB1dCByYW5nZXMgKFtgXCJiaW4tbGluZWFyXCJgXShzY2FsZS5odG1sI2Jpbi1saW5lYXIpIGFuZCBbYFwiYmluLW9yZGluYWxcImBdKHNjYWxlLmh0bWwjYmluLW9yZGluYWwpKS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIHBsZWFzZSBzZWUgdGhlIFtzY2FsZSB0eXBlIHRhYmxlXShzY2FsZS5odG1sI3R5cGUpLlxuICAgKi9cbiAgdHlwZT86IFNjYWxlVHlwZTtcblxuICAvKipcbiAgICogQ3VzdG9taXplZCBkb21haW4gdmFsdWVzLlxuICAgKlxuICAgKiBGb3IgX3F1YW50aXRhdGl2ZV8gZmllbGRzLCBgZG9tYWluYCBjYW4gdGFrZSB0aGUgZm9ybSBvZiBhIHR3by1lbGVtZW50IGFycmF5IHdpdGggbWluaW11bSBhbmQgbWF4aW11bSB2YWx1ZXMuICBbUGllY2V3aXNlIHNjYWxlc10oc2NhbGUuaHRtbCNwaWVjZXdpc2UpIGNhbiBiZSBjcmVhdGVkIGJ5IHByb3ZpZGluZyBhIGBkb21haW5gIHdpdGggbW9yZSB0aGFuIHR3byBlbnRyaWVzLlxuICAgKiBJZiB0aGUgaW5wdXQgZmllbGQgaXMgYWdncmVnYXRlZCwgYGRvbWFpbmAgY2FuIGFsc28gYmUgYSBzdHJpbmcgdmFsdWUgYFwidW5hZ2dyZWdhdGVkXCJgLCBpbmRpY2F0aW5nIHRoYXQgdGhlIGRvbWFpbiBzaG91bGQgaW5jbHVkZSB0aGUgcmF3IGRhdGEgdmFsdWVzIHByaW9yIHRvIHRoZSBhZ2dyZWdhdGlvbi5cbiAgICpcbiAgICogRm9yIF90ZW1wb3JhbF8gZmllbGRzLCBgZG9tYWluYCBjYW4gYmUgYSB0d28tZWxlbWVudCBhcnJheSBtaW5pbXVtIGFuZCBtYXhpbXVtIHZhbHVlcywgaW4gdGhlIGZvcm0gb2YgZWl0aGVyIHRpbWVzdGFtcHMgb3IgdGhlIFtEYXRlVGltZSBkZWZpbml0aW9uIG9iamVjdHNdKHR5cGVzLmh0bWwjZGF0ZXRpbWUpLlxuICAgKlxuICAgKiBGb3IgX29yZGluYWxfIGFuZCBfbm9taW5hbF8gZmllbGRzLCBgZG9tYWluYCBjYW4gYmUgYW4gYXJyYXkgdGhhdCBsaXN0cyB2YWxpZCBpbnB1dCB2YWx1ZXMuXG4gICAqXG4gICAqIFRoZSBgc2VsZWN0aW9uYCBwcm9wZXJ0eSBjYW4gYmUgdXNlZCB0byBbaW50ZXJhY3RpdmVseSBkZXRlcm1pbmVdKHNlbGVjdGlvbi5odG1sI3NjYWxlLWRvbWFpbnMpIHRoZSBzY2FsZSBkb21haW4uXG4gICAqL1xuICBkb21haW4/OiBudW1iZXJbXSB8IHN0cmluZ1tdIHwgYm9vbGVhbltdIHwgRGF0ZVRpbWVbXSB8ICd1bmFnZ3JlZ2F0ZWQnIHwgU2VsZWN0aW9uRG9tYWluO1xuXG5cbiAgLy8gSGlkZSBiZWNhdXNlIHdlIG1pZ2h0IG5vdCByZWFsbHkgbmVlZCB0aGlzLlxuICAvKipcbiAgICogSWYgdHJ1ZSwgcmV2ZXJzZXMgdGhlIG9yZGVyIG9mIHRoZSBzY2FsZSByYW5nZS5cbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBmYWxzZWAuXG4gICAqXG4gICAqIEBoaWRlXG4gICAqL1xuICByZXZlcnNlPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhlIHJhbmdlIG9mIHRoZSBzY2FsZS4gT25lIG9mOlxuICAgKlxuICAgKiAtIEEgc3RyaW5nIGluZGljYXRpbmcgYSBbcHJlLWRlZmluZWQgbmFtZWQgc2NhbGUgcmFuZ2VdKHNjYWxlLmh0bWwjcmFuZ2UtY29uZmlnKSAoZS5nLiwgZXhhbXBsZSwgYFwic3ltYm9sXCJgLCBvciBgXCJkaXZlcmdpbmdcImApLlxuICAgKlxuICAgKiAtIEZvciBbY29udGludW91cyBzY2FsZXNdKHNjYWxlLmh0bWwjY29udGludW91cyksIHR3by1lbGVtZW50IGFycmF5IGluZGljYXRpbmcgIG1pbmltdW0gYW5kIG1heGltdW0gdmFsdWVzLCBvciBhbiBhcnJheSB3aXRoIG1vcmUgdGhhbiB0d28gZW50cmllcyBmb3Igc3BlY2lmeWluZyBhIFtwaWVjZXdpc2Ugc2NhbGVdKHNjYWxlLmh0bWwjcGllY2V3aXNlKS5cbiAgICpcbiAgICogLSBGb3IgW2Rpc2NyZXRlXShzY2FsZS5odG1sI2Rpc2NyZXRlKSBhbmQgW2Rpc2NyZXRpemluZ10oc2NhbGUuaHRtbCNkaXNjcmV0aXppbmcpIHNjYWxlcywgYW4gYXJyYXkgb2YgZGVzaXJlZCBvdXRwdXQgdmFsdWVzLlxuICAgKlxuICAgKiBfX05vdGVzOl9fXG4gICAqXG4gICAqIDEpIEZvciBbc2VxdWVudGlhbF0oc2NhbGUuaHRtbCNzZXF1ZW50aWFsKSwgW29yZGluYWxdKHNjYWxlLmh0bWwjb3JkaW5hbCksIGFuZCBkaXNjcmV0aXppbmcgY29sb3Igc2NhbGVzLCB5b3UgY2FuIGFsc28gc3BlY2lmeSBhIGNvbG9yIFtgc2NoZW1lYF0oc2NhbGUuaHRtbCNzY2hlbWUpIGluc3RlYWQgb2YgYHJhbmdlYC5cbiAgICpcbiAgICogMikgQW55IGRpcmVjdGx5IHNwZWNpZmllZCBgcmFuZ2VgIGZvciBgeGAgYW5kIGB5YCBjaGFubmVscyB3aWxsIGJlIGlnbm9yZWQuIFJhbmdlIGNhbiBiZSBjdXN0b21pemVkIHZpYSB0aGUgdmlldydzIGNvcnJlc3BvbmRpbmcgW3NpemVdKHNpemUuaHRtbCkgKGB3aWR0aGAgYW5kIGBoZWlnaHRgKSBvciB2aWEgW3JhbmdlIHN0ZXBzIGFuZCBwYWRkaW5ncyBwcm9wZXJ0aWVzXSgjcmFuZ2Utc3RlcCkgZm9yIFtiYW5kXSgjYmFuZCkgYW5kIFtwb2ludF0oI3BvaW50KSBzY2FsZXMuXG4gICAqL1xuICByYW5nZT86IG51bWJlcltdIHwgc3RyaW5nW10gfCBzdHJpbmc7XG5cbiAgLy8gb3JkaW5hbFxuICAvKipcbiAgICogVGhlIGRpc3RhbmNlIGJldHdlZW4gdGhlIHN0YXJ0cyBvZiBhZGphY2VudCBiYW5kcyBvciBwb2ludHMgaW4gW2JhbmRdKHNjYWxlLmh0bWwjYmFuZCkgYW5kIFtwb2ludF0oc2NhbGUuaHRtbCNwb2ludCkgc2NhbGVzLlxuICAgKlxuICAgKiBJZiBgcmFuZ2VTdGVwYCBpcyBgbnVsbGAgb3IgaWYgdGhlIHZpZXcgY29udGFpbnMgdGhlIHNjYWxlJ3MgY29ycmVzcG9uZGluZyBbc2l6ZV0oc2l6ZS5odG1sKSAoYHdpZHRoYCBmb3IgYHhgIHNjYWxlcyBhbmQgYGhlaWdodGAgZm9yIGB5YCBzY2FsZXMpLCBgcmFuZ2VTdGVwYCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgZGV0ZXJtaW5lZCB0byBmaXQgdGhlIHNpemUgb2YgdGhlIHZpZXcuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAgZGVyaXZlZCB0aGUgW3NjYWxlIGNvbmZpZ10oY29uZmlnLmh0bWwjc2NhbGUtY29uZmlnKSdzIGB0ZXh0WFJhbmdlU3RlcGAgKGA5MGAgYnkgZGVmYXVsdCkgZm9yIHgtc2NhbGVzIG9mIGB0ZXh0YCBtYXJrcyBhbmQgYHJhbmdlU3RlcGAgKGAyMWAgYnkgZGVmYXVsdCkgZm9yIHgtc2NhbGVzIG9mIG90aGVyIG1hcmtzIGFuZCB5LXNjYWxlcy5cbiAgICpcbiAgICogX19XYXJuaW5nX186IElmIGByYW5nZVN0ZXBgIGlzIGBudWxsYCBhbmQgdGhlIGNhcmRpbmFsaXR5IG9mIHRoZSBzY2FsZSdzIGRvbWFpbiBpcyBoaWdoZXIgdGhhbiBgd2lkdGhgIG9yIGBoZWlnaHRgLCB0aGUgcmFuZ2VTdGVwIG1pZ2h0IGJlY29tZSBsZXNzIHRoYW4gb25lIHBpeGVsIGFuZCB0aGUgbWFyayBtaWdodCBub3QgYXBwZWFyIGNvcnJlY3RseS5cbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgcmFuZ2VTdGVwPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogQSBzdHJpbmcgaW5kaWNhdGluZyBhIGNvbG9yIFtzY2hlbWVdKHNjYWxlLmh0bWwjc2NoZW1lKSBuYW1lIChlLmcuLCBgXCJjYXRlZ29yeTEwXCJgIG9yIGBcInZpcmlkaXNcImApIG9yIGEgW3NjaGVtZSBwYXJhbWV0ZXIgb2JqZWN0XShzY2FsZS5odG1sI3NjaGVtZS1wYXJhbXMpLlxuICAgKlxuICAgKiBEaXNjcmV0ZSBjb2xvciBzY2hlbWVzIG1heSBiZSB1c2VkIHdpdGggW2Rpc2NyZXRlXShzY2FsZS5odG1sI2Rpc2NyZXRlKSBvciBbZGlzY3JldGl6aW5nXShzY2FsZS5odG1sI2Rpc2NyZXRpemluZykgc2NhbGVzLiBDb250aW51b3VzIGNvbG9yIHNjaGVtZXMgYXJlIGludGVuZGVkIGZvciB1c2Ugd2l0aCBbc2VxdWVudGlhbF0oc2NhbGVzLmh0bWwjc2VxdWVudGlhbCkgc2NhbGVzLlxuICAgKlxuICAgKiBGb3IgdGhlIGZ1bGwgbGlzdCBvZiBzdXBwb3J0ZWQgc2NoZW1lcywgcGxlYXNlIHJlZmVyIHRvIHRoZSBbVmVnYSBTY2hlbWVdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS9kb2NzL3NjaGVtZXMvI3JlZmVyZW5jZSkgcmVmZXJlbmNlLlxuICAgKi9cbiAgc2NoZW1lPzogc3RyaW5nIHwgU2NoZW1lUGFyYW1zO1xuXG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIHJvdW5kcyBudW1lcmljIG91dHB1dCB2YWx1ZXMgdG8gaW50ZWdlcnMuIFRoaXMgY2FuIGJlIGhlbHBmdWwgZm9yIHNuYXBwaW5nIHRvIHRoZSBwaXhlbCBncmlkLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYGZhbHNlYC5cbiAgICovXG4gIHJvdW5kPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogRm9yIF9bY29udGludW91c10oc2NhbGUuaHRtbCNjb250aW51b3VzKV8gc2NhbGVzLCBleHBhbmRzIHRoZSBzY2FsZSBkb21haW4gdG8gYWNjb21tb2RhdGUgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgcGl4ZWxzIG9uIGVhY2ggb2YgdGhlIHNjYWxlIHJhbmdlLiBUaGUgc2NhbGUgcmFuZ2UgbXVzdCByZXByZXNlbnQgcGl4ZWxzIGZvciB0aGlzIHBhcmFtZXRlciB0byBmdW5jdGlvbiBhcyBpbnRlbmRlZC4gUGFkZGluZyBhZGp1c3RtZW50IGlzIHBlcmZvcm1lZMKgcHJpb3LCoHRvIGFsbCBvdGhlciBhZGp1c3RtZW50cywgaW5jbHVkaW5nIHRoZSBlZmZlY3RzIG9mIHRoZcKgemVybyzCoG5pY2UswqBkb21haW5NaW4sIGFuZMKgZG9tYWluTWF4wqBwcm9wZXJ0aWVzLlxuICAgKlxuICAgKiBGb3IgX1tiYW5kXShzY2FsZS5odG1sI2JhbmQpXyBzY2FsZXMsIHNob3J0Y3V0IGZvciBzZXR0aW5nIGBwYWRkaW5nSW5uZXJgIGFuZCBgcGFkZGluZ091dGVyYCB0byB0aGUgc2FtZSB2YWx1ZS5cbiAgICpcbiAgICogRm9yIF9bcG9pbnRdKHNjYWxlLmh0bWwjcG9pbnQpXyBzY2FsZXMsIGFsaWFzIGZvciBgcGFkZGluZ091dGVyYC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIEZvciBfY29udGludW91c18gc2NhbGVzLCBkZXJpdmVkIGZyb20gdGhlIFtzY2FsZSBjb25maWddKHNjYWxlLmh0bWwjY29uZmlnKSdzIGBjb250aW51b3VzUGFkZGluZ2AuXG4gICAqIEZvciBfYmFuZCBhbmQgcG9pbnRfIHNjYWxlcywgc2VlIGBwYWRkaW5nSW5uZXJgIGFuZCBgcGFkZGluZ091dGVyYC5cbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgcGFkZGluZz86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGlubmVyIHBhZGRpbmcgKHNwYWNpbmcpIHdpdGhpbiBlYWNoIGJhbmQgc3RlcCBvZiBiYW5kIHNjYWxlcywgYXMgYSBmcmFjdGlvbiBvZiB0aGUgc3RlcCBzaXplLiBUaGlzIHZhbHVlIG11c3QgbGllIGluIHRoZSByYW5nZSBbMCwxXS5cbiAgICpcbiAgICogRm9yIHBvaW50IHNjYWxlLCB0aGlzIHByb3BlcnR5IGlzIGludmFsaWQgYXMgcG9pbnQgc2NhbGVzIGRvIG5vdCBoYXZlIGludGVybmFsIGJhbmQgd2lkdGhzIChvbmx5IHN0ZXAgc2l6ZXMgYmV0d2VlbiBiYW5kcykuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBkZXJpdmVkIGZyb20gdGhlIFtzY2FsZSBjb25maWddKHNjYWxlLmh0bWwjY29uZmlnKSdzIGBiYW5kUGFkZGluZ0lubmVyYC5cbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBwYWRkaW5nSW5uZXI/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBvdXRlciBwYWRkaW5nIChzcGFjaW5nKSBhdCB0aGUgZW5kcyBvZiB0aGUgcmFuZ2Ugb2YgYmFuZCBhbmQgcG9pbnQgc2NhbGVzLFxuICAgKiBhcyBhIGZyYWN0aW9uIG9mIHRoZSBzdGVwIHNpemUuIFRoaXMgdmFsdWUgbXVzdCBsaWUgaW4gdGhlIHJhbmdlIFswLDFdLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gZGVyaXZlZCBmcm9tIHRoZSBbc2NhbGUgY29uZmlnXShzY2FsZS5odG1sI2NvbmZpZykncyBgYmFuZFBhZGRpbmdPdXRlcmAgZm9yIGJhbmQgc2NhbGVzIGFuZCBgcG9pbnRQYWRkaW5nYCBmb3IgcG9pbnQgc2NhbGVzLlxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqIEBtYXhpbXVtIDFcbiAgICovXG4gIHBhZGRpbmdPdXRlcj86IG51bWJlcjtcblxuICAvLyB0eXBpY2FsXG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIHZhbHVlcyB0aGF0IGV4Y2VlZCB0aGUgZGF0YSBkb21haW4gYXJlIGNsYW1wZWQgdG8gZWl0aGVyIHRoZSBtaW5pbXVtIG9yIG1heGltdW0gcmFuZ2UgdmFsdWVcbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGRlcml2ZWQgZnJvbSB0aGUgW3NjYWxlIGNvbmZpZ10oY29uZmlnLmh0bWwjc2NhbGUtY29uZmlnKSdzIGBjbGFtcGAgKGB0cnVlYCBieSBkZWZhdWx0KS5cbiAgICovXG4gIGNsYW1wPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogRXh0ZW5kaW5nIHRoZSBkb21haW4gc28gdGhhdCBpdCBzdGFydHMgYW5kIGVuZHMgb24gbmljZSByb3VuZCB2YWx1ZXMuIFRoaXMgbWV0aG9kIHR5cGljYWxseSBtb2RpZmllcyB0aGUgc2NhbGXigJlzIGRvbWFpbiwgYW5kIG1heSBvbmx5IGV4dGVuZCB0aGUgYm91bmRzIHRvIHRoZSBuZWFyZXN0IHJvdW5kIHZhbHVlLiBOaWNpbmcgaXMgdXNlZnVsIGlmIHRoZSBkb21haW4gaXMgY29tcHV0ZWQgZnJvbSBkYXRhIGFuZCBtYXkgYmUgaXJyZWd1bGFyLiBGb3IgZXhhbXBsZSwgZm9yIGEgZG9tYWluIG9mIF9bMC4yMDE0NznigKYsIDAuOTk2Njc54oCmXV8sIGEgbmljZSBkb21haW4gbWlnaHQgYmUgX1swLjIsIDEuMF1fLlxuICAgKlxuICAgKiBGb3IgcXVhbnRpdGF0aXZlIHNjYWxlcyBzdWNoIGFzIGxpbmVhciwgYG5pY2VgIGNhbiBiZSBlaXRoZXIgYSBib29sZWFuIGZsYWcgb3IgYSBudW1iZXIuIElmIGBuaWNlYCBpcyBhIG51bWJlciwgaXQgd2lsbCByZXByZXNlbnQgYSBkZXNpcmVkIHRpY2sgY291bnQuIFRoaXMgYWxsb3dzIGdyZWF0ZXIgY29udHJvbCBvdmVyIHRoZSBzdGVwIHNpemUgdXNlZCB0byBleHRlbmQgdGhlIGJvdW5kcywgZ3VhcmFudGVlaW5nIHRoYXQgdGhlIHJldHVybmVkIHRpY2tzIHdpbGwgZXhhY3RseSBjb3ZlciB0aGUgZG9tYWluLlxuICAgKlxuICAgKiBGb3IgdGVtcG9yYWwgZmllbGRzIHdpdGggdGltZSBhbmQgdXRjIHNjYWxlcywgdGhlIGBuaWNlYCB2YWx1ZSBjYW4gYmUgYSBzdHJpbmcgaW5kaWNhdGluZyB0aGUgZGVzaXJlZCB0aW1lIGludGVydmFsLiBMZWdhbCB2YWx1ZXMgYXJlIGBcIm1pbGxpc2Vjb25kXCJgLCBgXCJzZWNvbmRcImAsIGBcIm1pbnV0ZVwiYCwgYFwiaG91clwiYCwgYFwiZGF5XCJgLCBgXCJ3ZWVrXCJgLCBgXCJtb250aFwiYCwgYW5kIGBcInllYXJcImAuIEFsdGVybmF0aXZlbHksIGB0aW1lYCBhbmQgYHV0Y2Agc2NhbGVzIGNhbiBhY2NlcHQgYW4gb2JqZWN0LXZhbHVlZCBpbnRlcnZhbCBzcGVjaWZpZXIgb2YgdGhlIGZvcm0gYHtcImludGVydmFsXCI6IFwibW9udGhcIiwgXCJzdGVwXCI6IDN9YCwgd2hpY2ggaW5jbHVkZXMgYSBkZXNpcmVkIG51bWJlciBvZiBpbnRlcnZhbCBzdGVwcy4gSGVyZSwgdGhlIGRvbWFpbiB3b3VsZCBzbmFwIHRvIHF1YXJ0ZXIgKEphbiwgQXByLCBKdWwsIE9jdCkgYm91bmRhcmllcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGB0cnVlYCBmb3IgdW5iaW5uZWQgX3F1YW50aXRhdGl2ZV8gZmllbGRzOyBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICpcbiAgICovXG4gIG5pY2U/OiBib29sZWFuIHwgbnVtYmVyIHwgTmljZVRpbWUgfCB7aW50ZXJ2YWw6IHN0cmluZywgc3RlcDogbnVtYmVyfTtcblxuICAvKipcbiAgICogVGhlIGxvZ2FyaXRobSBiYXNlIG9mIHRoZSBgbG9nYCBzY2FsZSAoZGVmYXVsdCBgMTBgKS5cbiAgICovXG4gIGJhc2U/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBleHBvbmVudCBvZiB0aGUgYHBvd2Agc2NhbGUuXG4gICAqL1xuICBleHBvbmVudD86IG51bWJlcjtcblxuICAvKipcbiAgICogSWYgYHRydWVgLCBlbnN1cmVzIHRoYXQgYSB6ZXJvIGJhc2VsaW5lIHZhbHVlIGlzIGluY2x1ZGVkIGluIHRoZSBzY2FsZSBkb21haW4uXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgdHJ1ZWAgZm9yIHggYW5kIHkgY2hhbm5lbHMgaWYgdGhlIHF1YW50aXRhdGl2ZSBmaWVsZCBpcyBub3QgYmlubmVkIGFuZCBubyBjdXN0b20gYGRvbWFpbmAgaXMgcHJvdmlkZWQ7IGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgKlxuICAgKiBfX05vdGU6X18gTG9nLCB0aW1lLCBhbmQgdXRjIHNjYWxlcyBkbyBub3Qgc3VwcG9ydCBgemVyb2AuXG4gICAqL1xuICB6ZXJvPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhlIGludGVycG9sYXRpb24gbWV0aG9kIGZvciByYW5nZSB2YWx1ZXMuIEJ5IGRlZmF1bHQsIGEgZ2VuZXJhbCBpbnRlcnBvbGF0b3IgZm9yIG51bWJlcnMsIGRhdGVzLCBzdHJpbmdzIGFuZCBjb2xvcnMgKGluIFJHQiBzcGFjZSkgaXMgdXNlZC4gRm9yIGNvbG9yIHJhbmdlcywgdGhpcyBwcm9wZXJ0eSBhbGxvd3MgaW50ZXJwb2xhdGlvbiBpbiBhbHRlcm5hdGl2ZSBjb2xvciBzcGFjZXMuIExlZ2FsIHZhbHVlcyBpbmNsdWRlIGByZ2JgLCBgaHNsYCwgYGhzbC1sb25nYCwgYGxhYmAsIGBoY2xgLCBgaGNsLWxvbmdgLCBgY3ViZWhlbGl4YCBhbmQgYGN1YmVoZWxpeC1sb25nYCAoJy1sb25nJyB2YXJpYW50cyB1c2UgbG9uZ2VyIHBhdGhzIGluIHBvbGFyIGNvb3JkaW5hdGUgc3BhY2VzKS4gSWYgb2JqZWN0LXZhbHVlZCwgdGhpcyBwcm9wZXJ0eSBhY2NlcHRzIGFuIG9iamVjdCB3aXRoIGEgc3RyaW5nLXZhbHVlZCBfdHlwZV8gcHJvcGVydHkgYW5kIGFuIG9wdGlvbmFsIG51bWVyaWMgX2dhbW1hXyBwcm9wZXJ0eSBhcHBsaWNhYmxlIHRvIHJnYiBhbmQgY3ViZWhlbGl4IGludGVycG9sYXRvcnMuIEZvciBtb3JlLCBzZWUgdGhlIFtkMy1pbnRlcnBvbGF0ZSBkb2N1bWVudGF0aW9uXShodHRwczovL2dpdGh1Yi5jb20vZDMvZDMtaW50ZXJwb2xhdGUpLlxuICAgKlxuICAgKiBfX05vdGU6X18gU2VxdWVudGlhbCBzY2FsZXMgZG8gbm90IHN1cHBvcnQgYGludGVycG9sYXRlYCBhcyB0aGV5IGhhdmUgYSBmaXhlZCBpbnRlcnBvbGF0b3IuICBTaW5jZSBWZWdhLUxpdGUgdXNlcyBzZXF1ZW50aWFsIHNjYWxlcyBmb3IgcXVhbnRpdGF0aXZlIGZpZWxkcyBieSBkZWZhdWx0LCB5b3UgaGF2ZSB0byBzZXQgdGhlIHNjYWxlIGB0eXBlYCB0byBvdGhlciBxdWFudGl0YXRpdmUgc2NhbGUgdHlwZSBzdWNoIGFzIGBcImxpbmVhclwiYCB0byBjdXN0b21pemUgYGludGVycG9sYXRlYC5cbiAgICovXG4gIGludGVycG9sYXRlPzogU2NhbGVJbnRlcnBvbGF0ZSB8IFNjYWxlSW50ZXJwb2xhdGVQYXJhbXM7XG59XG5cbmNvbnN0IFNDQUxFX1BST1BFUlRZX0lOREVYOiBGbGFnPGtleW9mIFNjYWxlPiA9IHtcbiAgdHlwZTogMSxcbiAgZG9tYWluOiAxLFxuICByYW5nZTogMSxcbiAgcmFuZ2VTdGVwOiAxLFxuICBzY2hlbWU6IDEsXG4gIC8vIE90aGVyIHByb3BlcnRpZXNcbiAgcmV2ZXJzZTogMSxcbiAgcm91bmQ6IDEsXG4gIC8vIHF1YW50aXRhdGl2ZSAvIHRpbWVcbiAgY2xhbXA6IDEsXG4gIG5pY2U6IDEsXG4gIC8vIHF1YW50aXRhdGl2ZVxuICBiYXNlOiAxLFxuICBleHBvbmVudDogMSxcbiAgaW50ZXJwb2xhdGU6IDEsXG4gIHplcm86IDEsIC8vIHplcm8gZGVwZW5kcyBvbiBkb21haW5cbiAgLy8gYmFuZC9wb2ludFxuICBwYWRkaW5nOiAxLFxuICBwYWRkaW5nSW5uZXI6IDEsXG4gIHBhZGRpbmdPdXRlcjogMVxufTtcblxuZXhwb3J0IGNvbnN0IFNDQUxFX1BST1BFUlRJRVMgPSBmbGFnS2V5cyhTQ0FMRV9QUk9QRVJUWV9JTkRFWCk7XG5cbmNvbnN0IHt0eXBlLCBkb21haW4sIHJhbmdlLCByYW5nZVN0ZXAsIHNjaGVtZSwgLi4uTk9OX1RZUEVfRE9NQUlOX1JBTkdFX1ZFR0FfU0NBTEVfUFJPUEVSVFlfSU5ERVh9ID0gU0NBTEVfUFJPUEVSVFlfSU5ERVg7XG5cbmV4cG9ydCBjb25zdCBOT05fVFlQRV9ET01BSU5fUkFOR0VfVkVHQV9TQ0FMRV9QUk9QRVJUSUVTID0gZmxhZ0tleXMoTk9OX1RZUEVfRE9NQUlOX1JBTkdFX1ZFR0FfU0NBTEVfUFJPUEVSVFlfSU5ERVgpO1xuXG5leHBvcnQgZnVuY3Rpb24gc2NhbGVUeXBlU3VwcG9ydFByb3BlcnR5KHNjYWxlVHlwZTogU2NhbGVUeXBlLCBwcm9wTmFtZToga2V5b2YgU2NhbGUpIHtcbiAgc3dpdGNoIChwcm9wTmFtZSkge1xuICAgIGNhc2UgJ3R5cGUnOlxuICAgIGNhc2UgJ2RvbWFpbic6XG4gICAgY2FzZSAncmV2ZXJzZSc6XG4gICAgY2FzZSAncmFuZ2UnOlxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgY2FzZSAnc2NoZW1lJzpcbiAgICAgIHJldHVybiBjb250YWlucyhbJ3NlcXVlbnRpYWwnLCAnb3JkaW5hbCcsICdiaW4tb3JkaW5hbCcsICdxdWFudGlsZScsICdxdWFudGl6ZSddLCBzY2FsZVR5cGUpO1xuICAgIGNhc2UgJ2ludGVycG9sYXRlJzpcbiAgICAgIC8vIEZJWE1FKGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2EtbGl0ZS9pc3N1ZXMvMjkwMikgaG93IGFib3V0IG9yZGluYWw/XG4gICAgICByZXR1cm4gY29udGFpbnMoWydsaW5lYXInLCAnYmluLWxpbmVhcicsICdwb3cnLCAnbG9nJywgJ3NxcnQnLCAndXRjJywgJ3RpbWUnXSwgc2NhbGVUeXBlKTtcbiAgICBjYXNlICdyb3VuZCc6XG4gICAgICByZXR1cm4gaXNDb250aW51b3VzVG9Db250aW51b3VzKHNjYWxlVHlwZSkgfHwgc2NhbGVUeXBlID09PSAnYmFuZCcgfHwgc2NhbGVUeXBlID09PSAncG9pbnQnO1xuICAgIGNhc2UgJ3BhZGRpbmcnOlxuICAgICAgcmV0dXJuIGlzQ29udGludW91c1RvQ29udGludW91cyhzY2FsZVR5cGUpIHx8IGNvbnRhaW5zKFsncG9pbnQnLCAnYmFuZCddLCBzY2FsZVR5cGUpO1xuICAgIGNhc2UgJ3BhZGRpbmdPdXRlcic6XG4gICAgY2FzZSAncmFuZ2VTdGVwJzpcbiAgICAgIHJldHVybiBjb250YWlucyhbJ3BvaW50JywgJ2JhbmQnXSwgc2NhbGVUeXBlKTtcbiAgICBjYXNlICdwYWRkaW5nSW5uZXInOlxuICAgICAgcmV0dXJuIHNjYWxlVHlwZSA9PT0gJ2JhbmQnO1xuICAgIGNhc2UgJ2NsYW1wJzpcbiAgICAgIHJldHVybiBpc0NvbnRpbnVvdXNUb0NvbnRpbnVvdXMoc2NhbGVUeXBlKSB8fCBzY2FsZVR5cGUgPT09ICdzZXF1ZW50aWFsJztcbiAgICBjYXNlICduaWNlJzpcbiAgICAgIHJldHVybiBpc0NvbnRpbnVvdXNUb0NvbnRpbnVvdXMoc2NhbGVUeXBlKSB8fCBzY2FsZVR5cGUgPT09ICdzZXF1ZW50aWFsJyB8fCBzY2FsZVR5cGUgYXMgYW55ID09PSAncXVhbnRpemUnO1xuICAgIGNhc2UgJ2V4cG9uZW50JzpcbiAgICAgIHJldHVybiBzY2FsZVR5cGUgPT09ICdwb3cnO1xuICAgIGNhc2UgJ2Jhc2UnOlxuICAgICAgcmV0dXJuIHNjYWxlVHlwZSA9PT0gJ2xvZyc7XG4gICAgY2FzZSAnemVybyc6XG4gICAgICByZXR1cm4gaGFzQ29udGludW91c0RvbWFpbihzY2FsZVR5cGUpICYmICFjb250YWlucyhbXG4gICAgICAgICdsb2cnLCAgLy8gbG9nIHNjYWxlIGNhbm5vdCBoYXZlIHplcm8gdmFsdWVcbiAgICAgICAgJ3RpbWUnLCAndXRjJywgLy8gemVybyBpcyBub3QgbWVhbmluZ2Z1bCBmb3IgdGltZVxuICAgICAgICAnYmluLWxpbmVhcicsIC8vIGJpbm5pbmcgc2hvdWxkIG5vdCBhdXRvbWF0aWNhbGx5IGFkZCB6ZXJvXG4gICAgICAgICd0aHJlc2hvbGQnLCAvLyB0aHJlc2hvbGQgcmVxdWlyZXMgY3VzdG9tIGRvbWFpbiBzbyB6ZXJvIGRvZXMgbm90IG1hdHRlclxuICAgICAgICAncXVhbnRpbGUnIC8vIHF1YW50aWxlIGRlcGVuZHMgb24gZGlzdHJpYnV0aW9uIHNvIHplcm8gZG9lcyBub3QgbWF0dGVyXG4gICAgICBdLCBzY2FsZVR5cGUpO1xuICB9XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBzaG91bGQgbmV2ZXIgcmVhY2ggaGVyZSovXG4gIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBzY2FsZSBwcm9wZXJ0eSAke3Byb3BOYW1lfS5gKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaW5wdXQgY2hhbm5lbCBzdXBwb3J0cyB0aGUgaW5wdXQgc2NhbGUgcHJvcGVydHkgbmFtZVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hhbm5lbFNjYWxlUHJvcGVydHlJbmNvbXBhdGFiaWxpdHkoY2hhbm5lbDogQ2hhbm5lbCwgcHJvcE5hbWU6IGtleW9mIFNjYWxlKTogc3RyaW5nIHtcbiAgc3dpdGNoIChwcm9wTmFtZSkge1xuICAgIGNhc2UgJ2ludGVycG9sYXRlJzpcbiAgICBjYXNlICdzY2hlbWUnOlxuICAgICAgaWYgKCFpc0NvbG9yQ2hhbm5lbChjaGFubmVsKSkge1xuICAgICAgICByZXR1cm4gbG9nLm1lc3NhZ2UuY2Fubm90VXNlU2NhbGVQcm9wZXJ0eVdpdGhOb25Db2xvcihjaGFubmVsKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgY2FzZSAndHlwZSc6XG4gICAgY2FzZSAnZG9tYWluJzpcbiAgICBjYXNlICdyYW5nZSc6XG4gICAgY2FzZSAnYmFzZSc6XG4gICAgY2FzZSAnZXhwb25lbnQnOlxuICAgIGNhc2UgJ25pY2UnOlxuICAgIGNhc2UgJ3BhZGRpbmcnOlxuICAgIGNhc2UgJ3BhZGRpbmdJbm5lcic6XG4gICAgY2FzZSAncGFkZGluZ091dGVyJzpcbiAgICBjYXNlICdyYW5nZVN0ZXAnOlxuICAgIGNhc2UgJ3JldmVyc2UnOlxuICAgIGNhc2UgJ3JvdW5kJzpcbiAgICBjYXNlICdjbGFtcCc6XG4gICAgY2FzZSAnemVybyc6XG4gICAgICByZXR1cm4gdW5kZWZpbmVkOyAvLyBHT09EIVxuICB9XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBpdCBzaG91bGQgbmV2ZXIgcmVhY2ggaGVyZSAqL1xuICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc2NhbGUgcHJvcGVydHkgXCIke3Byb3BOYW1lfVwiLmApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2hhbm5lbFN1cHBvcnRTY2FsZVR5cGUoY2hhbm5lbDogQ2hhbm5lbCwgc2NhbGVUeXBlOiBTY2FsZVR5cGUpOiBib29sZWFuIHtcbiAgc3dpdGNoIChjaGFubmVsKSB7XG4gICAgY2FzZSBDaGFubmVsLlg6XG4gICAgY2FzZSBDaGFubmVsLlk6XG4gICAgY2FzZSBDaGFubmVsLlNJWkU6IC8vIFRPRE86IHNpemUgYW5kIG9wYWNpdHkgY2FuIHN1cHBvcnQgb3JkaW5hbCB3aXRoIG1vcmUgbW9kaWZpY2F0aW9uXG4gICAgY2FzZSBDaGFubmVsLk9QQUNJVFk6XG4gICAgICAvLyBBbHRob3VnaCBpdCBnZW5lcmFsbHkgZG9lc24ndCBtYWtlIHNlbnNlIHRvIHVzZSBiYW5kIHdpdGggc2l6ZSBhbmQgb3BhY2l0eSxcbiAgICAgIC8vIGl0IGNhbiBhbHNvIHdvcmsgc2luY2Ugd2UgdXNlIGJhbmQ6IDAuNSB0byBnZXQgbWlkcG9pbnQuXG4gICAgICByZXR1cm4gaXNDb250aW51b3VzVG9Db250aW51b3VzKHNjYWxlVHlwZSkgfHwgY29udGFpbnMoWydiYW5kJywgJ3BvaW50J10sIHNjYWxlVHlwZSk7XG5cbiAgICBjYXNlIENoYW5uZWwuQ09MT1I6XG4gICAgY2FzZSBDaGFubmVsLkZJTEw6XG4gICAgY2FzZSBDaGFubmVsLlNUUk9LRTpcbiAgICAgIHJldHVybiBzY2FsZVR5cGUgIT09ICdiYW5kJzsgICAgLy8gYmFuZCBkb2VzIG5vdCBtYWtlIHNlbnNlIHdpdGggY29sb3JcblxuICAgIGNhc2UgQ2hhbm5lbC5TSEFQRTpcbiAgICAgIHJldHVybiBzY2FsZVR5cGUgPT09ICdvcmRpbmFsJzsgLy8gc2hhcGUgPSBsb29rdXAgb25seVxuICB9XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBpdCBzaG91bGQgbmV2ZXIgcmVhY2ggaGVyZSAqL1xuICByZXR1cm4gZmFsc2U7XG59XG4iXX0=